#include <gtest/gtest.h>

#include <toycrypto/hash/sha3.h>

class Sha3_512Tests : public ::testing::Test {
protected:
    void SetUp() override {
        m_hfun.reset();
    }

    SHA3_512 m_hfun{};

    const std::string m_empty_digest =
        "a69f73cca23a9ac5c8b567dc185a756e97c982164fe25859e0d1dcc1475c80a615b2123af1f5f94c11e3e9402c3ac558f500199d95b6d3e301758586281dcd26";

    const std::string m_fox_digest =
        "01dedd5de4ef14642445ba5f5b97c15e47b9ad931326e4b0727cd94cefc44fff23f07bf543139939b49128caf436dc1bdee54fcb24023a08d9403f9b4bf0d450";

    const std::array<std::string, 134> m_cmp = {
        "a69f73cca23a9ac5c8b567dc185a756e97c982164fe25859e0d1dcc1475c80a615b2123af1f5f94c11e3e9402c3ac558f500199d95b6d3e301758586281dcd26",
        "f5f0eaa9ca3fd0c4e0d72a3471e4b71edaabe2d01c4b25e16715004ed91e663a1750707cc9f04430f19b995f4aba21b0ec878fc5c4eb838a18df5bf9fdc949df",
        "6a699d4a1436b87667df834e7c1e68dc88fd4bce387d0389e5928fb144a8f55fb40d6f3a742d8522b83ceaa7367ebfe1408c3e35ce2af0ef51da4a16f1e82aa9",
        "852cf44eb8d38715c847976b6de526564136d756fa99b4ad5a825fd6e3ba5d891c7b4576b11410a6e951fffa3399b14be1da4222d53b5a35ff236d659899e857",
        "990fb60e8dbd852804795c671db3a97b8b37685976026672d8164b05be0e9a555ed0a9e30668abcfaed0a34d3610dbbbb9ac615a92545b4654f13a39cb7f07ba",
        "5d6593f3699e0ebd2ccea48fa10f7b1b8911c3a8719e120d516df4b307ec065a406bd2c5c1bf30f329e5710deb7904407dd233733b9adb51eea27c38be9aa2a2",
        "3864ce88fd195595d25d91192e92aad6024ee4d5aeb0aa3676f45d46af1eb891438f42ca54958cb6e98a42fd8e78541e1fc2a0df32e00aeb769fdfdcbd3b8da2",
        "c4c2389fe0506116f31e15fadae2efc15e394c0f2e0e9dbb30e1177be29650c990ed746663d4946c0d2ba0bc5e2c3aa2b5140cc2df7760eaea8af7e7868fc7c3",
        "2309d2783b5e5bba7d6386bd985e89fc3e404ec5ea9d100b0478b512118f80d2e61e09abaaf03816eac0a9da6ab2095753caab271c8fc0ac72b284570f39e9f4",
        "a5be9ba6607fc11947ae379fbe9f0e2fd6b3fcda709e24d4e466e13e99c13727164c4e42fe7315cfed96d44840b21f2b586b0ce54310857b2016543526c176b0",
        "523f8d6a78960fac6648cb710a7e83497c943dcae7760c983285a3ed5c8f1fc3cb9db91856369a8b0010d8a58c8b0fcfa46f6f59efdec7c82e8eead9615ed999",
        "04f6a772b95d6741b0b18a5a46f008486a98b09b664ba76e7c00630aa08c248c5a1ce4f80f67bd23c87f9ced43c55ddf1ebd0bb8ced1d8eb4f0f7e5ff9517f8e",
        "47252da812b3f86dc303335237224215aa495bcb879e875560d669bee795856b91efb00d13ec3d66596e9692b0df4dfbe06bcd06880fe5d7ad7e2442a83ed867",
        "c31f240c8faead49afbb262558e50f5645d343279797a5f654ee9f930929af9d40869dd696f179d36fb8c1d15d116cb0550a7c7da8df62fe40eaff34bb812d6e",
        "0104363d8fe79b3a353df68ecbacf5cbc893f7948ff204a11a8598985ed23ec85df03b0be1a7a662abfce8f982c203a803de65047dfd48ae688ea4fb7e4dec0b",
        "0d68b835ae3f5222a370bbe3f85bcf4b1dc438b56786f2ac56fefd8b0689e208fdf113f3f71d80a0c803027d4904e96d8428741e9f539fd411a1c91ab7a315a2",
        "b7604afff30479557e6bb707fda8d1be8b849df565b83ceb0bcf9185f3bc1dd7cb7934084055cc0f226ffa25c4f92cd7f1a49af2a2e6d5256a3aebb62e137559",
        "5e4ddbcbd43238287d648fa6088ad53a54790ead90cdf9ade2e62a1a25a656779bed89c6bfb894dda325149f38020a10b6bf714569ff8120f7d7e0ea9490330e",
        "07685b8d67fd7b01a5c98be5b5633a0ea4fc89a57a1288ddff8642fc52ad6bbe036894a7758a6d316e0936e4052074f1795e497539390bda708c0c8481bd5006",
        "018330d84df724e429922a2bb7ed46c0dd09fcdd2887ec0df1ec8d4fa72fcecda163eb045db48cabab6ae6168581eaae4c0c0a317f7ca4a4d8192e1f0846f93e",
        "64c5f33456cc474a8f81b5f54427b21b492258cae477937b1cf9a33a00003387b5f1d002419b929b92bc9261bdc6462fdc20e8a8c305be4b6c2a2f0145365fd2",
        "890ace14472a8e301fe33c8432d9fb4608ee3f61f36c17941b4588fc148b1c76a424b948d34484011938d01282eccfa2824af7d3b2fbff17a7847827e81f9cda",
        "cbba8e2878854520bcf7218f3917ef9dc7bf848fde9ef9d936db20d531273f75095ccafe38a5b379d9c31eaaa0501a11b840e7f5849ee82e97aab8a7065fb823",
        "16e0a03b571301fcb0a743756ca136e987daec0b6d4ff16221adb53576125404999738fffb13a4cad7461f384cdc6984545e511975d6441ae79514560b5584de",
        "b0a1c1f6f138336d5ed1ef9625b5ad21038be57ee094fea8f21f9e590ed50291d92c1fbc5be0fdb0613047711f0fe23f0be64d46beec7102366b31257c5e1737",
        "09c9ccb1b01ee931527bf4f206f83f97cd9570804f4e5b7c3330621d4f2a519a44cf10846a7e96e60d76569cbf4d22ce6e0f69c8f98f476a088e5e7596cb4f08",
        "863603f3fa0d88ca6853404acc534d7d30c4e6d82b8db9deda202078fa807c1630729f4e5998d09d730b304179e3ca90a4b3a3b81f5e92018c213a28a8f9d28f",
        "561f7652f6d740616b161b5797f842f19e59f99c3f5a5ccf37e6e7c1d1080d9ddeb23849e416b0f638da8eb3a015c9bce7734008bfe32a1bbf46c05d27ab9288",
        "15e2d90b99622ea53b17354a3f0bed5e081ade26c204e6abfb304450befb41a35dc94aca5b3a6cfc1412e906dcf658c59e784ac463a412ef69597932ffa1f417",
        "f96dfd27e13b64b820d1970791e25499506abcd3d50ef10d8e2ce599fdd3721d42da75d4bc1486bd53a4f4a19b1d397452b00e4d4535be883f7d667763309d2f",
        "2463c3cefa1864e163f310d608596994b428ddad8782e7ac5b511651cc19d26283ca4d2ffa9ee14ed24caffcecd59dcfcc07e8f496588de23fa04569bc1e1df6",
        "cb3195cc18d8df243e0c8707a4c2aeac38fcb80bcf16bb8772ef9f876d81010b62e80c935d0c7b017a69f48a290e17d2ca635c17ac814cb70a24137e49f61834",
        "7ebe404743078b0949178b3bab3f58f90596c19b1b32c8f8e8830fd47486d68aa947658064f768539ee16e51eb854095aa8eaf0668aa61d6b58e71d8f6964154",
        "35bddf32680cda41605acb3f642c33e49fc41533f6960d1e39bdb2df428a9009fec50a026c9bfe7ffc45e8c6f4916d6cfc53e74041f463acee9165fef125862d",
        "e269fb741aca6b0d11e32fe3a016aed59b5568055992abe450ebe8125488fb5d34244c82f5009fb4815c804d674e6e192442c026929269ec96545843bc9c4ef9",
        "9e83a36e5d862b226db66b4590add398eac66ce15d872f7b0a405b31bdfb8f9dd39f793cf051d979dd4adf0549c84fda16dacc022da5e50394c4141a6f00eddf",
        "9bf46d5862f6c4f9d5a3b6892d4a63fdf816b1e32f64ba8a24bdee5b0d051d6ef7e54b2f9a9fe527b829eb5c833e7459aba8302dc8f269f50afd291708bc2d3d",
        "26bd103540a10f689982d4d564f674c3603f59a2c7e6888ccd700d248e50b1467eb394bca251b06cbf2b792bac3603cdb2c853c34bfefd51d098bd78f1fdc27e",
        "76aefd041bd06861c7fb956d488ad8537675be4ad28d8380eaf2ce6ad1d363ecc1d007e0565c6d2906123dccb04e21a0ddd6ad4d85ca9f73d1f38ea778cce031",
        "12399bd25ef4650785cfff8d481f9ebba9db6d1045055b78b26a5ee3a1e90ef0cb742f0111c3ac8cf4d66baa95be7e6866fbff9546406f589d4da93e971c728f",
        "03e50470d34069c0532a4ebe2aed39dd7b36d009eb78b180e993142166aef2e5b0d81d754c28868da0fb443ac332183da46817f6a8dbcb4d6b31da634408ea48",
        "6c03136f3f7cef609d8f542b814b08d19d2f15a5de1db2c0293fed6974106cb993ff7473f48f8602d378147192575e3fe105a74bd782719cf896c3cc9aa367fb",
        "a4b2cb181cc7df811548aebb1f075003958588dbd234edc1acd3df6ca7d316f6ed12a4a4e50fa726c7ff121fdaa72b68185253d2f9d684213cc110459d0ed522",
        "5fcf0d8463f9cc81ac6e2263d53106e0defd832e503a61c9697b39c5a553da35f50b14ed6a88b631920ca51a695866c8554e746cf9a86b7df2af9d0d8f563365",
        "8db8d28f766202e2a445d7690669d6f99fc85f4e0a69e7cb4fc6506aa9784ae432e959ebb1ba979ef496a4710dac39377e0443f4d95ff1c03a4ef87235becb2c",
        "84c8ad2995372ded9af56fbddbf27c53a55ff56b0279b2cb5e4c7500751027cf5fbe6202c6708548c963734eff05d657481c773ce2a9f7d7cafa53a03dc92699",
        "4a807cee1eaf4e27b94ac4b0687cc9732d14f6042e1eed0a07746925237b040e9ada22cc2dff8d368b113d81b257c0d65e084db47dbcd7f177fc37d742513808",
        "86d07d0bd1f809f4b22d0a7b0249f57338bc1a9614c160bcb7421ebfecebcefd008d00f8626378e70c9de6ffbb6078e6c166c92769a736e0711804d7c1d56481",
        "bf863f050e9469eec2935d9da1f780a7f08bdd9427a2dd7408ac35d73ceb24101ca38c11df5a0ff8b090326160bb647358cae80f1c6d7bc682e864e048d611b2",
        "80c36ff6419e29cdaa4ef5162509323c1c217a640581a2230eb9855760f6a4694101408ac21d94179fbfa75ef4915e2bbcde92bbb6ed8aa02cbe1d635e00833c",
        "3271911a4cd82e81ef23382f56c54b62ef2e249572f60c5188b3d70dbb14ac03e2b7c06da1eee24634a71f0f886c0e381d54c1d53d5a620943c11c2767dc867e",
        "de7f5c2af2f2e90a48cdc8f55759c2eb72bbd2b02883d6e5e9b2ebf471c92333d53167572d75dd41f2a528f0790c6dc8dc35d9208a6bb02aa29e82d2533af272",
        "d9d877821345447582e008c989b7dc6071c1e4d6d4576566177785b3ebfc24d17017f64585ac5830398af8209f1a1b6c58e0320685a4111a31ba89ee9c67f9cd",
        "8b03d3b85bea9368d196dd6094e2b9349460891d3206af8bee6f2a343f34f90347feda661eb7c5845408cc10a48523f088b68468baacfae201ed054150945cf6",
        "d360965dfb3237264d9bd36c18933ec675f54efa549c5bbd252ac9effc853ac98c189ff805267e4b27e5af8799efe255d099031593efed210947e71fba9c9a81",
        "745b8fb6947b32b04e04c5698276e58186c84eb0cce17d1545c984e6bed8a5d0b077363ef039b7576e935a6d4a5f47172b254ba008160c55e62d38b9cd5e4274",
        "112907fd615ba0b4375e0ed3693d25519e2798461953ac6ce1006580be703c3bf677fc8faa0d3dab6885ea6289243f76ae3bd513e4eadd4d9539a362f4da4a76",
        "5405a0da3e51f9654f3f933fc7e2280fec35465624553bc42f104eb9a2694a4310e9af5aaa4529cc966ed55fcba97b6e95e22308d78b84c410987c458421b7d3",
        "8b3a75dc8cab170af93b4de551d77f650ddbdc9a7aff9f9e94703a975fc96c1b484c307f133f86437c74d1716ed64bb2ce58cf90ee7a652f9edd8bd4cbdf9f1a",
        "95d63ed3914d1d8db612a41b4c18e2f8b0b48f5d6cdeb59fd439f22ac6a084fa396ddbd82e46195e505355cf93144fbe33e993a8afd10bac9cc312868804f45f",
        "51e51636d1fcac073578a2529fce94c3b6e64ac0e14bbf57b17f0fb69e2d68da5adfee406ca13216ee49afc0f99145222a136033682319e9d3554dbb067afe3a",
        "8886eee33d60bd24ed6cb2dfa04aa262b04890f36b5fa9e460a87d2c15ed503a4c3b9223d801433f1bf1bd9ba03a15730bc2d294ec57839b925dbc9f6404de67",
        "8ebc481aa7c055441614a4652bb0081cc22f7fbdf06f708f592cd24f8512bbde029a1be958b75dc24404bcfa47fb2a5e237b25a9c7a9d0c4a86a7bee83649263",
        "b95404ff364061cf2a76d95d747c15f2cebff131a49ac09f34a134a396829b9931738ffbdec10b46a876b97ee1e0c9a4e66b6f6a6928f559b597f284c0d25d34",
        "00f9f12ffd297a251e3670c9cb9ea25231afb1fd2c5e463f9104466589e103b436fe7fd2b06263ac1b2ff776d9ccc3871ea471912c31e99b3dc146a37335d4f3",
        "bec7b721d28747333dabdb777a97ffc82c19f9eb2bf2201b3a1c0f79b7dd87c195a65611cf715f298833b98e23753f49f72bd16e1427ebceb32d3fd5fc58a042",
        "3ae85822c63f533294253f52acdd89cd912f3ea94edd6eb8b3a1df903214d46a16b13a62d8ee85eb8acf6645b9e481d17ec4a31fcd32698a61ebcfbbb674c71d",
        "79d41c7705aaa66a280b805ee56ed8a0cccd754bc20152612b845ae9be2f6b335dc5b979b608ded976a741f86f51d0b02faf113594fe53da23b7625592397fbf",
        "7633a78dc694283ec19c9f89e71220d5a91e8073f2ea10c6d022f237ad5ba10b2003d57ad2bc23136c2dd9555adf64c0c524cd0df5a8bb88435f9a46ab02515f",
        "520304d3f407f9adcc8ca29223cf479508e458955bd570e7dc054138715e4bec21b5d9f8ca6acf90de9c4bcc8ca90669473b598c970ac5207592fdae2d090c47",
        "f7c56c40b52b674e15392f1045f7563a8273f09262486be0a492eaa9329323a0b3df730b2e4c5832e191cc4e598363c7e4f80d45332feda8e90634176741958f",
        "e9e7f1016227a4d58c3a2c597adc2f58de10b6e78f17ff079624fede5eb8341bf0ebeda4f8296d5a070751ab3b7ffa48d35950f793e21f9c16c095b3b354da5e",
        "dbbb35fbed5f380b3c29bf4a42ad47a0f9d77ca8622f2a64b1ef0655a2bb978542bc579167647de0903e454dd45316c8c4878aade59e9f663df4d9327b333eef",
        "a4d32577ac925077aacdc65964041ba05d9058596f6157937f8748e4a1833aa7c954a4e45c4e1132a52737c675d3f9edae3018c51ba388f540bcc4590b4e293d",
        "98e0132119fd63d0ba94c79558f20f6a5fe1c41f6c7ac662f71036d3e7f2f21f6badb8c2e05f3706eda8c6371273034febd27f7aec002aaaab125d98658b6f3e",
        "088d493125b5193b3b5f776997c68ddf123d6355ab65ea7acb860811ea3c0ebaba792d68856fd8f4d3e9514b848c12836127aba8b1e8ecb327b9f47fb8f5ddb5",
        "938f9f0ec9df83b4f5b63f50004db7ce3d4ecc6d8d2f13f525885b3a1850e0a91891233517965462fecafced9c5d5886beffc6ae0a92068b6e40e9bb42b7bfdc",
        "ff79761bf9727e1e55e1cae80bc955a98f5743d088caa2a73cf26ed7dcb3b2ac7aadedbb39ac18364826dfac137d1286a016f77e15ae1b069a18e2867515c4e0",
        "67b0582520824f0a2aab9bcf8a046cbf85bc06a10155459e967815207d19d2e5e6707b76e1823f0ef8261f85b67162fd901df08973ad6487bfb5fff6131d8bb0",
        "f846b1dfd6606d42a34e516d2531c5ecdb9f609793fd39932cd77f266f73d1e6acf0702388210bf0a28a0ade4759b33bec5f6f9008e34da7e7e6acd7b200fa44",
        "3376a87ed979ae2a84a2d438f86cc2a195ab99b5b46fd30cbb6968eb52c42c178180192cee869d20d743598132d1cf99c28eea579be92f58fe61bb2526c6b91a",
        "39a4289b07971f6fc22f9641a7e12781c49e3f977cf11ede6f3cf204a0bc19c7541de0e529f46a6aba70dc689f11fcb243acc22155802e800881e83dde3a8c27",
        "de2f545a48f85361db8a80fe86020d1431cc3136f51be0dc576e054bd58d1e2b991d0cd6178f91c658569a1d95cecd01d7d2056f28f739f406d158394bdbacce",
        "927e70c7b4211e5bf8d4b9e9741d11b5b36a10a3c58f65332fad0ba38533546485c6cc570855681bcd5bb97c564784d097517588fd518b227c24b05b1ba994cf",
        "21337c08bd6265499d600c07dacbcd2a0f5eecabe536db26b5b8dca06f9f2ad569eabb33166285d4dddbbe2a92b69a92e9e838f2a209fdcedb339d7e7d70e310",
        "4dc51c04b633a643ed83249438da14cf349cb2effacb7d9d05f220a0bfea5bda73f6fc5febb8d63af4965e069fba299dc9195fd3a02de60ce128740b34715fc1",
        "baec97f86e55a983c3f40aa8b58d81adfbf492e040040f26cda0a4f2cbe52aea5b35a1c45e3c32e1bea98b654ca415d0a358a59c651bdb42d3f7ca3da7232ae6",
        "3f423383b4b33c30270a379ddfe3e1f53bcdd84f8ac8b61dc18b949ede4c1865ee30dc17ca97ef13bfa70dd32804123e58e3aadae978cc7ea03d6539919e3960",
        "2c424d1f747cd2c161c26b38ccf325e373ce10eb79cf17f458d88cd4c418eddc75e115d919085d650e14d5226cca455ecfce2348485aacf8272e10684a70d818",
        "e3267eeed46a4719b3d95e8e87721848382b873ff94f28df73daf5c61b454649f1359c391e072ee72bbafa412a2cb4d74c1f0b779e1de2d5f5ee73a849f86837",
        "8c60eaa1d162647137f57513052a7aa13862c0ecc17f2c32dd05e108ecfcc8ec080ca4d330eeefe8398560ee1c660a65df5c61d56deb377ea906874c2e58b99a",
        "39b02d86cddf6f739461cfa4626ba5e4110076830b2ed93de43d3d90de5a110339ad3e991cdbe8d460d41033cff623e3e96c37d6e385019142b990cfa51b68c2",
        "b044a6023dc92dfed4cc50e9e1af7ef429a3679d940f4127922e27837c7094e7606cb5e5534e36eba411956a786c1ba5624b7c96205542283464100f7c23bd40",
        "65dfa0f6d1e3b41046cd06a376a474bd3da070d335e580e5bc1ebb52f03f3bddb4cffc15fe4362871a52eae04b04b2141b3d0e64beece25f932674aee70e7d3b",
        "8931ab12d6691b84328f6e091f09c001ea0244c890351a12c2e3c60f01a39fec0b3068a820b62d81046155cca3650aaa8a0d9077346b011bf1702805d8185beb",
        "ebfdd6987bc8c7f907f9644d71ea3ffd7a6b7c46693252267cf42278b551f79ad93f2baac30e6c0c167eea26b3fd554a4d952d12a775ab7c7c4b79e3a0247860",
        "f14d469e183cb76f91791780c3c0be51499dfcbb651f83bb20d2f09c054a578e80173d27be36dbb07b9cfab6fbd48f284c8d63283aa804362143d89793fe6cf0",
        "be333052ecd6a865ebd75f66e71d4b96c1348ac925a187ff12be3d76d75f2d34b5a61b10af3be5319234f77d1fce735a655fbf295f5b147023fd44c77f40e1be",
        "11cc2df4f21ed8c0e8564fb066bb7ca42b7b305fda2915c6724a16f8632e4b514777627a6774b64ac1081f315f4d7aa1ec367471cc04455a94f6582cb0683a80",
        "ced483584856cbf067f97f11c06d411feca44431752bca07982fb1970a674d008ae4215686be4032f14814626ea9a2df2edac130e0c7dffe1056b118b38a7e4b",
        "5426a4b166d059c6fc9ee9ff0c0037b4274c432a98b71a2e2254d911a908971e0972b43e7c0c89623b0b6434a5a3d728796e509e0c8eda34af87c79293b4a6ce",
        "8ed486fc8cd1cb3f9f59f10f0f4aa4bb8ec89c7d5c7c7feeb7a2d4e658e9ba8ef3182302fa8ae8ff68ec5c6c5a28806149be52ceb9b03f5dbffdf0f3a559916d",
        "f7d6973d52f94b5b94c7213c490e398793857feb6cd7e45e74224f67a4cfd0babbf45e7edf8cde7ac636c26af1b367f1ecf4e030ce1e57abd4749f56d8c4058c",
        "868cce733e48c3fbaf84462be05e761c8b4bf529a52964d616e2c4c824dac56bb030cc761c8e19348897a58a2f2329e2f6d8b4b8526a5b779a961f3d5a079ba3",
        "c18333d72d4458d33694688978d0a6e55d0edfa89a157185c18b9ea4d05dbb28031896221d9ed040a0b72d01211e532cc5fed0ed05f78abd71199e876f4a1260",
        "36a997b5a525d42dff1c8919db2863d5a0602b427448435203b0abdbc595ed17721c4ebfccd277ba5a0f20daa812fa896ea136333ef2419560dd6d53d7c9d651",
        "bee1e2d9c74f15f8b0ac654bfb61424007ca176edb9a92f20f85744217073fc6e0f35013471e92d2c5e235234fb6f6cddea050ff738820d83d383c4e11581143",
        "93f27f92f6715ff933fc174ef0622c0654658de202a3f54c46b6f447c3c31d7addb20ccdadbd1b7200a67f2881967b9a5a9837793fc78c5af99677938c13ea03",
        "9c6b26b8fed770823b2c2ac604c167f17a8024b102e1ad2d3b3bdf8cf2dc74330ca880bb498c9fd516c352b834b0ca049838f530e4e7caa5af0139495e499a20",
        "65263091997e00f410170617b87e7ee030ae923a8100f4f2eb23c02ac9a8ee5a81c6aacc518d5b405b3e7a3658a9d7bcf71c901e9dd29e6df5bb00658935f7ab",
        "8995a4678e40422553e802e1955682f04a00b973cda5d332d5a8c78059e1ef55e5709711e079a0ecd8ca230a85d8ed18effce48e8bceecd2fae1a1493f46fc4f",
        "b9fc0d7b61f25eef30ad3675d650802678987e1b516c7bb7b87365fee233ff9c571ca60a6eb18d90d251cd68884e0841eb6e78501ac3558649bd82fe076994fc",
        "40543ddb862c6e4a254d8eedae2a059cfb216ada7061d54aa9d90b9817935128b24508537bbdd9cc9b596169fc49e6e2e424d18fd8ec94e39d1fd5daa410b67f",
        "9202e91c910143b5ab03c0e968b993f1021bed4556aa8f2a3eeee097e27575ebc9a5e9ff09a92211ecfeec6335e8f127e6153f8c295db8712c5581d216c2be96",
        "941f363d5cad4180744a8fb51087dd4edb9b03bc3617142c55c2f02e1e6c549e4932edff5182653d628b8d143110d253190def8c4d1e9f1b244864eab7124439",
        "a3e77eddd76626767b2df01543face1b2c13346923b91e431c75b40e712484d72df6a2479b5514c7046075a42fa644553f5bbef9f1908d5d06784d640e403984",
        "1dd5b69dacb527056f7240f9b4ab4e7b9c3c78b8822fc96982eaffe348f1cf0a596fb37b470d1aa128415436a753cb90e622b77f4c0f88606e8df45be3145dde",
        "8395347e4c008ccd9d28ffc344a262962b014fbb380496e8bf346a0df084f3d0908a58a90897573c1895c101bab51cd1e644de92920ae3f57b1b10b00266f3f5",
        "f9427e2e17b413aaf16c1a9daf177b9052cfdfd3b02c3b0c1d8889eabacd343647f88cf328b4e852d0ab992b5d01b84fd9b5caf4911210123f3a9634f0363027",
        "a386e092d5f0d2ed8e6ba8edd5daeec0caf608d1c4d27d3032959286d7c23cdb2ad06d8e33413f0dcced79fcdd235ed340a159f2527f2c61ed381bfe858c8052",
        "5fc9f1cddb0af9168fe6e237fbf28b9edb39547dfacaa7f3fe0517e6d8d03feb91d830e6751fb09c59dfce222141d215787eefe550b06e9a83153d9679502a64",
        "88e4ed0dcc611e1a340823df806f5ae586f2f7807fa4ecb3e8128df1a9c1b2f44c175fd00b3d4445f76f9aa293201623692b8623f1db485bd7d7671bf73d44d9",
        "bfb52db06d07db91a59c847b39d321ef75d07501a71b1cc12c49b9da937deb9408f0d1ca6f043e109981ba1d49fa84c1def5cb4fa53a2c3cfbf0f6f07204747b",
        "a8458e0a501295dd11b1cae236adb82a6abb7157f1a1aac5e91722f75e21e9e2faa15081b809c88277479000326ce693c04f4ec13f1c28a6d68fe82e6e4adaaa",
        "eb4f740ed31b283131f2cbbc0e3cb1ec95b39cec5ea6f5c26d6c618ba094a6e52edd96601a97ab30e66f979a4b5d4932d6c734336157fe5fd9ea86994e323c5d",
        "6768225e44dc5ff7cc4699380e5d827bb240aaf77438469e99159c995cbacc6b5f16062aa047ef73c4d6cfdb2985625b8637e735096cc3d89dcb7e7921623bbe",
        "16f4e4abb93f28e1b836e22650021d4a03e650439a59036d682f0beebad766003a155329b9c6b556671b8f9d9af305f1694db900a8ab097967bd53116c2ad31e",
        "21c2986b6dc0e849e98501084ecee47a5dd685746b817bcfd74c203445e595b7cd441323e8eb09d80434cbdb635a7d083a1b1939c4b3fc2d0107ff89ebb2f1ab",
        "279b35ca0f48480641c63aef88a1c3277e89f4656262d3c9c86ed1a93e32aeb63bbc4788e4f7e0963b465783b215cafb46adc3977771c77e27a9142b722b344c",
        "6d37d7dba6741081845ffcef3eca9eabbbfe5958aefb8d11dd80a302a128b659c778a0195b225b3a983b1a2cb5c403f841c76b5f6e6530090aabbb6ea187bc53",
        "5074eb53c42d66ba829782c8af1b4a484feec8b46cff4271a6557f556b391fd426e43289fbfc35346a9f8861b47dfce1f93d94ae7e5acc88fc0ba383c66b2dec",
        "d544bd6f51ff76149f1e1d33f21af61f5a69a2a225592eb3aaa7052ae7456cd3dfc908771bf73310f33a24908eca42568ffffbb7586997fe6388c7ba6eadca9c",
        "9afe05279d31c19090ef5ae7eb85a688d979952e3b9088549c9d71fb6e2daeab2d29554c848f18a968cefe7bc4ef015951849ed651fc767f771226074a1d8b5c",
        "3b7e5cc7e1d88f6c81138b5a21ccdfeff22f29c6dc5574442625321766a5ef147ed109301e6b40fa50bedf79fba9cb47e0036e1231c76ccacab9300e9cfa26cc"
    };

    const std::string m_7000 =
        "b89092001cd335c336b259748aee6296509f074fe78a3679f9fa101ea52439485d8019f143f2ba6311bc7d66f13113a9ea9700ef61f4d327ee837ea50548ad92";
};

TEST_F(Sha3_512Tests, Simple) {
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_empty_digest);
}

TEST_F(Sha3_512Tests, ResetWorks) {
    EXPECT_NO_THROW(m_hfun.update("Hello", 5));
    EXPECT_NO_THROW(m_hfun.reset());
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_empty_digest);
}

TEST_F(Sha3_512Tests, BasicInput) {
    EXPECT_NO_THROW(m_hfun.update("The quick brown fox jumps over the lazy dog", 43));
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_fox_digest);
}

TEST_F(Sha3_512Tests, ChoppedInput) {
    EXPECT_NO_THROW(m_hfun.update("The quick brown fox ", 20));
    EXPECT_NO_THROW(m_hfun.update("jumps o", 7));
    EXPECT_NO_THROW(m_hfun.update("ver the la", 10));
    EXPECT_NO_THROW(m_hfun.update("zy dog", 6));
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_fox_digest);
}

TEST_F(Sha3_512Tests, Extensive) {
    int i, j;
    for (i = 0; i < m_cmp.size(); i++) {
        EXPECT_NO_THROW(m_hfun.reset());
        for (j = 0; j < i; j++)
            EXPECT_NO_THROW(m_hfun.update("A", 1));
        EXPECT_NO_THROW(m_hfun.finalize());
        EXPECT_EQ(m_hfun.hexdigest(), m_cmp.at(i));
    }
}

TEST_F(Sha3_512Tests, SevenThousandAs) {
    int i;
    for (i = 0; i < 1000; i++)
        EXPECT_NO_THROW(m_hfun.update("AAAAAAA", 7));
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_7000);
}

TEST_F(Sha3_512Tests, UpdateAfterFinal) {
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_THROW(m_hfun.update("Hello", 5), std::invalid_argument);
}

TEST_F(Sha3_512Tests, DigestBeforeFinal) {
    EXPECT_THROW(m_hfun.hexdigest(), std::invalid_argument);
    EXPECT_NO_THROW(m_hfun.reset());

    EXPECT_NO_THROW(m_hfun.update("Hello", 5));
    EXPECT_THROW(m_hfun.hexdigest(), std::invalid_argument);
}
