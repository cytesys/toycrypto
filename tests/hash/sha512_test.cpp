#include <gtest/gtest.h>

#include <toycrypto/hash/sha2.h>

class Sha512Tests : public ::testing::Test {
protected:
    void SetUp() override {
        m_hfun.reset();
    }

    SHA512 m_hfun{};

    const std::string m_empty_digest =
        "cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e";

    const std::string m_fox_digest =
        "07e547d9586f6a73f73fbac0435ed76951218fb7d0c8d788a309d785436bbb642e93a252a954f23912547d1e8a3b5ed6e1bfd7097821233fa0538f3db854fee6";

    const std::array<std::string, 134> m_cmp = {
        "cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e",
        "21b4f4bd9e64ed355c3eb676a28ebedaf6d8f17bdc365995b319097153044080516bd083bfcce66121a3072646994c8430cc382b8dc543e84880183bf856cff5",
        "282154720abd4fa76ad7cd5f8806aa8a19aefb6d10042b0d57a311b86087de4de3186a92019d6ee51035106ee088dc6007beb7be46994d1463999968fbe9760e",
        "8d708d18b54df3962d696f069ad42dad7762b5d4d3c97ee5fa2dae0673ed46545164c078b8db3d59c4b96020e4316f17bb3d91bf1f6bc0896bbe75416eb8c385",
        "53b74be8b295b733fdfafbd7d2a22b1686733740de7fdc592b26cf3e1874cfce158170ce9230e24696331a61829244e5d9f48abdacc9ffa8c4cb498724844cf8",
        "232d43e52834558e9457b0901ee65c86196bf8777c8ff4fc61fdd5e69fd1d24f964fed1bf481b6ef52a69d17372554fecb098fb07f839e64916bdd0d2abf018a",
        "fa069700da28b1e41a603e314d30cc7774ae0a730b5d03addcf701d67cbdc9c668a100210b5809f6c9f560447c9b0e61403b24ed785ce05a104658ef70f52244",
        "5f26ac324f43ebe475bcb2c28407d9372100c149ac7d6e160984691b771e4505a71e9d3ba7a30593bcd02c120cbecdede8753cf58ffa9b0e75f0aa1095270a93",
        "4ce72a574115e04e27cab883ce8bf5108213da64373263bdf1b129143aa2c6aae0920f3f628bd9bb416fccf99e1abab6ca8cc6f14fe8e82e9f5e6ea636f0508d",
        "1e9471ae2743c093063017a105cb1979014bee37da5ed99186fd50296cb8a30d3ff0c81ba9930bb3cbe7642b15e0e05e882af5b9be5201891d997e0d78e859fa",
        "2e75db45ffc1734a00608542d8a7635d7f599e4bdacbfcf0c4d5ab85bcc817aa461f1bd1d56de1b72e4ea91b94763a788ec764a4eb456b9ddbc98f0170f4abb7",
        "5fdb655eb56345c40d7c41291199dcd5fddc73b2e6b0e5e35228e3032b97b3eceeb8ad1510b7d410a13b86bce7bb4764d3cd4357b4f6e7afb805142eb0230982",
        "2a2fbf0aaa30a78331bad72d1f76b240cfd73d87be9f8a6b972b1c805f8dd13e4075ec256873b057f3829d297ae3d2ecf8432cc0d65fdb32248b7fc235f21327",
        "caa7c045ec1558c850485989bf2f01f7f1175f4645e05228fc363039ffd974881f7c34d8c34c4e8091148fbcfa9a1ed7e5ef407e3ed0b7740cc3328471737df2",
        "a716828ac2266e0ab9d3ff8ce5ade17306fe60913896c4ad46fec8e7db3473d56b5aea882bc59371ba0a9a6d66abddd252f0381dee84fb23d3c9e3a4a4f1e363",
        "f9f00414bc8d12c5d9eed722b8fcbce061eaba2005d34b8666c71b0efd27c707c627ce9d77e3444dd2621668faa32aacc82ec4150d4bf817005ff7a2569f17aa",
        "673a887fe1680c26d81d46d276e60b4dfd9c166034e72f69d68a77f4b0f74121d44b7968de8f55ba2615f6e720a2c743999cbcc07a04366d9f3646bcbc1198ce",
        "9c59e493fd67d43436da3b686dace5032f3e3283f36715799d58643e9f2672ba1ce3b50dc551181c324389bb4d638b8816d1c1e70b8dd8663255fd40e899407c",
        "e691adba605f9acaf8ae37a40b62bc09ba93e53c88467f202060f04656a57011b91a366b57581f1bc369dbcdadfbc8861cc5ab78070ab7b5f7da4a5a22c4de25",
        "c74ad1abf5ef250dcd363b28f9d76b5b62fa1e1c9a9fd7d62c261ad9758c16ed526d2afb29169d1116c1762ddfdb5e0f87345211370c9e5984f06543ccc392d4",
        "628633284c72085e2f8fbd772872595f4ad130128c059ef336c5647f79a9ca70993c7bb50b96cda8719dbf1bfd307cff75cea3ff2d4584e4db2312677ce3e9b3",
        "cb139851f23007749405d4e4b39543f0611a95f8ba3e92d1d2aac6d9473bae816f4973e3d8e224f7ea09cda4cd2223dfda63a065c5176f224e16db32c9776241",
        "2fc0fc75f8e9cab95ea9fa1d1d6724f0192c70b64b7ce5a4605d2a55392edff90ec8b485d5c0dd75ba36f6dbe89a16d3e9f664d148ddadd1f956ca2cd58b9d11",
        "01a28967cbfae690ffb1e40bf9f2315759ba93003b0a8882dba0d44698d4102794b6a7cf12031f64bb70ac769eebcb73eb01649bf815f09fc7c6a7e3638898b3",
        "9f1c1e438b8cceda02663a61a64c1c5fc6fb6238aa92d30e6d8d1a7b0cb29a8a6f26b63b9964ad876617f71ee7dc3c05205158c4ed4be327149652b1c6900825",
        "04704d934bbd42582fe7d6fb96e1ed8cf36abd1a43466b39a00a6d87de7681501081d4ef69ff4c9fa1cdf0cf36bd32af6ff24994ed059a6f1d7e722c3a4f90b0",
        "e437280844d8e95a85b47871e9d301204ee8605804baebc2d1ffb1d249d4403ae45f2ec3fd11c5ac5771b90b13763190132139001601aa009903880b2c354326",
        "4400b1a3dbe9ed6390a6b5cf58a71729f81c8da521e00781bff33e8696fe78612707149e8b4d241b8a8547ad4bcc529ad8c6ad6f7abea68aa2d1f750fa2d378b",
        "3c15e56bac2f78034cabd9c06502a67d55aaa2962b5a4a21634d509b515f5ec9e9fcaf7d1c21d888d2c1a182510d15978f1ea20c477bc131e678b199846c4761",
        "d0315c066991850467d8529b24897bbb75f597ad454abdd923c3da0555c849dcbe02d2ac872d48bf190fa6eb46f0bd1f609bc3dd81c41994dc0b95af8cdba6ff",
        "3c4c946a0f74c0719d8e5911bea9a76c1a401ad62104dc6fb76430bd6ec6b4a8da2285b5bc25d5933ce095551a59605dd8649bea5d56e7e22304a7f66198406e",
        "6fc5a577547be1f80ca1609747789bba02d944eb7fdd4f65d94eb4ef6947b678be320839597475ea545854f4f405a6825372e32ac1c61ac6711c1c9ea30aaa53",
        "ac800471de52f74e8d323237b1b913ca28bc0f46f26b88f8b25e25e733c1a608308a2239b89a4079a5d0805428b31e165a06129bb198332e5d071feab6271272",
        "f719d5e7606c27568bff99a23c6538269f54ccc2611117dda84d3c79a48d4e176e19af24e43742590efa4c844cc92e529c770037617101804a616dfca0a3fa95",
        "539950b57040b792e99b475cafff7f952e7f531a5e9e87f619c3c25b5100af015a117258eb091338cdd1ba10d141b2791a863b30a8c604eddbabc23319498090",
        "c78c0e67a52f90a15bcba4602712640c888b292305ba3230448467c7f0e67fea6de535f8456a8713923a3db192c7275c550575256c77e2cbfb1932e543856294",
        "6b349f893991f76286956b74cd5a69ea03b94ed70eb89318021883f69f913ae0c47ddccd5e6403fd62863b4e7e6a5d1fe0d2b675c68ceb453d1129695e987847",
        "58f6bba92e29f313fbab1cd4999e42b3ac4b594c9d870ce01344d4b10528216bb5fd488c575a799e04e8f64b33e24f9044f9873057f109c8afb7dce4ecffd9b3",
        "9cf9b943c2a24e710d8d458d9f1910c88c5314d72e10dabbf1e7bb313c7cd743fd17280f969a47597646bc1ea75940e66d432fb5c2ca8ebd8481b52b2ab7862f",
        "ef4bf8abf9e4ec2174e36e2e349afb4b7385fa4573df495fe07e32414f8362d53e729616a0297a15d01aeb929d1658254472592595324af3102422db155a586f",
        "394d36c395614a42195260d808e7e0b441af004d4a8e7613315343368ac3de43dea8f300e1b2369766bf45a178247b3d4111a65def8e83e2e823919eaf99a0ee",
        "b921488bc7d74e9619bbdd535f7ea80d0d50f05314e460582cf1f11bfe0073ea79dc2c47e944d17e19f7b5e1dcac72eb2e5311ed5d538c2560ddd3e97b0a3bce",
        "bf1e7c079e5648a2cd45e7360b403d6747c56d948a97f6887617624e9bdf2e4e62a2719dfc893adf6e79c6d994464e4b04cdfa543aa8972c17717522116110e6",
        "b2416f13089a732e7e25b9fa45a1f51fd6cd3ba3b90c6a8340506365da017ee3958d09ae325c38e84db12e64631aad3735c9b43f23f7777e04d586de93c08c99",
        "ca0ef543f21f13732de0a99f896c4c584c9402ed414a465a6cddb760cd13c053c9ee7659e0e6a268ec4a4e8cdb955aef8f2ae85721339ad1300c4c85071f51a5",
        "c3c901ad6efd4fa871a0f8a5b0b25da24f04f6c05ebeb8ab53abba3465fd66dc83e7adeed773187336cb88d988ebd3f8af00f3b1955e0b4354e293a31bb9a977",
        "2e0405f6c8c32d4bb849cc697cc5df053645d40535d5f1aee1e20ab64b102e918b66ffca24682ca0e05c8128dcd6a1418c65050b2523b582674c38fc9ea8005d",
        "6dd1ac0a9277967903431cf7121e94faa664693d3061726f1c711249d5a3d2754ce570747a877bdb6c218080b5c9a23db6294b850ec4b35b8fb72392bd56817f",
        "717daf3f3446d7a8bb5d7cf6e98d2252d93a70fe73136bdc8fbf2b794766aa51a8be1580cf68de0df0f8c7909937f27223d81e0b1e5acaade7b44331a23b16f0",
        "68bd81299c677518ed61a4201113e56efa2b7b35a4508eff4e5518fe08fec612bbcadfc3c6a57858c030185ab73cba71623d3ed60e002d18d1c53a373fbee96c",
        "fb289b6450b810afb101c59d8877f609390bc3f0818a09ceb533131f47310a913e85ab4453141c4dc2fe0d2db2ef10d278c1fc85191759e1eb840569e86028ab",
        "f009a78c2e8338a74bd40f4c0c981c04f26961eb90983d4a558eedeefa1293a4d87f8faafa181c7a710780a978d99a066299f57dbf2628c449f34e026c6230d3",
        "8bc3b1538123f9f1194850f0acbb800c1c9b9dbc0ad29d88f2ebdb61a816edcd776cde171d60742eece8c0ae32141c849db6549c4e209492fa81e50713752a49",
        "b08521903868636e9d9962bdaadeaa0d2ab5bde3e11432af24fc96df793b860e6d524e41d4d689fa592661fb2d948887a11ff93a96c17e9f940c308db141a3ff",
        "310bc5df527ae1192ef380c9f839737176b38b117c17319c91ac63b259a0bc8d81b65e931ab3db739724a55412e0438c4a3836fb8c861d60dfdd53d5b0ed91dc",
        "6c0b08938e14e449b7da5b6868a83af829afbd41ab328ed10c8fa4cd7c95ff7321ea859ab0c34240a94a9d21bdba1158dfe8e03253817e2346b676f17ade9033",
        "80b696886087d1e05a32df1e90409adcb8dec7d46ef81a727976572d8c07d07429b3ba4c3a55fdeb00ebed2d6c3987726e81aebbadb64f1e898a66fdcd379d9a",
        "8a32ba9e0679bfdbc278899d07fe9a2f6616c7d200005680f6a88c3896ed3d8c3215da90c47c175be393b902eafc1143505c5eae512bf5bd74bb54c60a844763",
        "171df56f38d159ec1cb1a3d308840da6bc4de7b8e16a24cab32375235e8161d44ad9d9eb13c48a8d62aac9edd28fe62589cbeaa8926ccd1a445964dbbed1c7a4",
        "9f0d35a207623d653cb2e8bf0dd39d1944fc41633391528f4df26bd68a012594d8cdd7707e3d283fe12b35734af6f3344224f092c42a0d1c149eb684922432d7",
        "bbb1d9e26b8bd24b5453c68e072b927215512266d3d91236e59eac9a9bdd76e7fb65d72b646ee371759354ff4717531dbe75af766fce6465aae8e2b3a7c9d685",
        "bd30aa99d5d69eb9b12d64e49c4689dcfcb54f851c06a8f889c0189e0af05fbc040c8d9c59d32930265779d6fc1d22c68fdad84bcd623a764ed0271c38f4fbe4",
        "4582bfd65351f9bdbbc0e7097122395bdffd5ddd100c08e534548c4f11c58bc265c9ac91bc2367ca7abed657184987cbd2a276d724de0945560ffdd2bd7a856b",
        "b973335129e4a8dd92d0984e16cff30899de8829be3c87df30d61a88e6bba8fe1767ffed6ee9a9e2665269cd6c7f3f0bfe8f9449cf16b924db57edfee8f12877",
        "9459164c6b4a58f46a4f4bc08133a5b9c6b50ca69e146ad19b6d10f3e2b2d96b575221ed8f7dedc390a19650cebe59f76f7d60f105e691ebdc14376ebb15e2b0",
        "71fafe41e31c7dbc2428b23bdf2c73adc76aa77465b06fa3787d01438a4821789a31be9632547426b83c978586b591317a900deea71c6bd9d45fa6ce675964ac",
        "2d188d01e18fd5cd483d6995218caea0038dd8e1624047f96b0daaafee3c00f04699f4dee1c9a50cb86c3fb5cdf1c1cb5efeafc62617571c223b665c5cfae0d2",
        "770a9aa6e15da08da30c88a594ecdb1354cb5342b3b9da31abe6f312e3e31575b9e7748ac7227d6a1414c6bd7b66552d857bb1df302c848648557317852081ef",
        "3afa33eefdb18a4f43c69c19d8bc8afa5634808e4155cee7b5af082235c22ee5a52821a381e813555a0366b44141159943cc2f8c12e662d0a84c7976147acb96",
        "56af1ea000d40a67d04501a891a5f3e99660000448cce71b09cfd8fd786ee7b39c36f5c6fce3e5c6e9505945958df17df86cc3378d6581c46f184fef21ffb06e",
        "ef13d806c0a48f690cf13ff89e37be4355e3b264efd746e1782e4c8c57d4f04dfe6c64447fe6093dcc353f8eacb2505b16be0003ef0ada2418eed5425fd5c626",
        "8dbcca5aa2b10dc002ffa10faba962eca158ee689efea45db7d1f440aff0fbf33c62338e9c0ae7ecb25700802eaeddd884e0548393f632076e8d064b2d7fe840",
        "faeb0e620a475f4870710803ddcad8ed1d37060a4f08057e9c9d151737cfde171575280ba27583ddf183e28fa691e00e18aaccd4c48207e9740cd62169dba342",
        "625932c0c0e195e2a5eff852ca6f671a35b87f2eea065a5cae497dbcc53518faafa28ba8b02cb2b27f1cee3c8256e93f6ea2e314895edf62f21d6eb4abb8394e",
        "d1dcd4319eca9f1fbf3972bf69e8959613e744f1a574e5a7fec063fc2098ad39ecbb3c83c593298c371853f60330227b27cccb9f6d155d57778dc0e7b0447906",
        "099bbbba6606e2f378141977b304d646cd42abedfd61c6b36f89ab0b705430bea3daf84b09b7ba1f5899bfa55e30e99833e5413fb8f9949308e0587c8a773c8e",
        "bffa8ffa29d86ba93ea0f1a1bb115c8cb8a4e056dddde3a6978c3f4b6bd1afda588c9dcb7860f786960dfd2700ef20c48d66d606559003ca77dd0f1130f56924",
        "fdd568ae9e85497ad001ceb3e3866cc803883676a2ac3c2de41317ab2c91a63452d66160d2cdfbe2663b7da7297cd1732f4fd48d825370dacdab85c4c52ae0e2",
        "a250bdc5ffff617d494c99572509cefae94e6e280c1218f2b582f812b9591f250314ef4e2fabdb7abe7917a5607645c292554778268ffc59010fc46367e5e1b1",
        "f1eca161c114fdc20fa15d8cd4b099b6df6e6122c025542094ea1348287126bf51e3f74f333d3d43693e5610fd90011c3e4afa6619ec141c22437c746da0087e",
        "b2bf8578eeab1aaeee7e51db684eccfdf2ad7048142e47a01646d26a3137528d0721362456a1333630f9ed7b61ec8a9b1f4ef2c40c35deffbea635acbe170b07",
        "35bb691957916852ac8919945a205e397d55565303f7164714d160ff85662b1ccc022f842c46192275d817504ab6f1190329cf57f6efcb9854f89349642c6791",
        "230465c20186f86f9c0255196bbdd876e444c515f714e8a32402dd66ae13d1c84fb4ab6182913a9c9b174d3767ff2eaa2f794789f3d19f8b1c8e0ba78b2b81d0",
        "a6a24cbcb9c198b3a6f3a3358e40aefb3c78149c3a1a8ad71c63df7a9a9ccb5a1bc8bab1ef490ce284f0f82fa377397d7930abb4144531e8e8d91b379e337fec",
        "d0ce7fec737d6e221ab801decfca374cf272913c6d44845a54bfc9400d6b34dfad7b57b95b36825dd423514490f90a0bc249f4ab30dd7f227edb817fb843dd3a",
        "aa4acff27639061e8fa9a93d69d7ddcb0c4153b3c6657451d2120a4beb262a96a5550aa4bedc866258ad1ed35cd2392949b556a3f1c5402b95f7cbba7309ab6d",
        "17711264f730eaf705741ac9b36dbac622976a52a354e08041d1430556f39b00579edea2632391f0512fa6cbd65c1111276f77d45908a20d69ec97413795d56c",
        "18da0b649cc755828b2169f6c38e97d6ca26295d9ee7c56495acc59e2b3fb35b97b459ca66488ec4514da884f5d0d6ccd0974c164d28acb2d43afacf6c9f1afd",
        "aac36fabcd11aea104c4c61af85422624539b7a926c01aae22b8378acc56a0901b6eb1b59b30e8bcdaa3a34680e5f20d0e25474d18b84009f368b508a19a2222",
        "9b1186f212412e5dfa66951196186b022ff1b2f3c9857e88508abd4b1ea0b41d2862a9eae006d925d0dba6026eeff4c654c838366cd1c60b17eafaa84f74d7e2",
        "6b1e65650d8eab45c10a2d4ef57af611cd37e561816209da93f9fe4391310218a40bc07f03a7c61ca20bf1cb52ba5b14f813f737db5a63bcb1102b74ab41c0ec",
        "f5b1a84ab106e02d56b61ee4ae7c978a72e9fccd7dc185708181347bdd54014e55b9342554d7354ac083deb280fbb282cd0a3bb61fc3c1c24bcc2e396a574318",
        "9c37eaba0d86fa1f56404903ae47bbd5133c3a5685e6b301a838bad884c450bac1f6d2cc72ad715be2dc3406bb556fefda20f1258e23c39cee9f9c701c70b0ea",
        "88006fa6fbe6a985bd6bafaa361fe77f96756462b98dc504f0c610db544ed41bcf75d2dd5ba67ee6bb42b6b38ba276cfbbcc34bb2c55033d18a039114b6c387c",
        "fe8ff0e739b8ccef7cfaabe107fb95d0b4e006d256a090bea5fa27f056d6dd72fb2dae61f5e927ef08810742e02d3301084194ec12f8a757d83f73e32e53b2a1",
        "209bc6a86c31950570fa250941e4089ffcf78c9eb490e715e27a5df709756de1d4b8bf4f76aa9d82be7be96a77d702543a4abb6c85d098eaa7d87024377bb2fd",
        "c9d2bd91736b0a41d69c6a2c179ee04a83b00ad126214ba02681e037da5a88daf9938a7aced080721cc1b4ea84cc20bab4f6e07ca93c03d649332485da92afd5",
        "7223b3d0405f08fa088d12e40b8a2ee96b80a09ff16adbbe3efb46bb95175bce71f91becea9045abb24b26437a072f7f173b5d413c93ab16498cb35477a0508d",
        "647f29c362e25272b0e5f8bc1e4b69f5072f477d14bd3a4f3bd48a360d9f7ed8fb77f0eb4d4f8b1627e7931513509a57f970772d0f1a345404818b7050d8f8a9",
        "6bf9128eb9f53ead6e1923745e7d8867c4418e06d4cd63171eb1974d4f9c154466a68b3bd65431d0765bb3e7185f9ad2840adc02e3780f20168ef16b80d9fc4e",
        "95c8a866272a76315b891c509e54ef3ebf652ad7e189465586c3021e2947da13275aee1893bf9d7e6c9d06284a6541a3c00e34d9a52c1412f85391d040466517",
        "1400e67819e9806911cf5e5be9af04ad54decadb999430b5eba019e9a84bed5512c292d0f5c0cb270f55f559e891d9f60b8eb3bba1353ed40502d35ce233ae28",
        "ceb370c81bd824660f5d4dbb63280bcfcd3fa1d8588bdbec4a0fbb70536286ddaa0a4a7a43227df98f9b68929474feae0a138aac9987475f2b9d6f8317f83e31",
        "e9e6e3c13f2d5f36775be5117301104bd8de19491b6744319642eeffb02227f8b164afa788dc6257df0060304da3bb64aeb94b4fbb9b25210db564da9326795f",
        "1dcbbf2a964c34db99f5b2cae0d3fa75bf9dfca39dc3e55cfa525c6c0b31ff5a4aaca234423022651f2ef8f03d3d88daeacfa4425689f8b172ef4bb31c318bce",
        "a405791e20c17d9653160b6caaa2ce89deb3ac5545cc5ab22c57c0a8b1bc9fd5822a20893b6447b91073929ff61fe68ca065cdae92e0380bdf2fda5f6e1d9c1f",
        "93ce7b7ba58f654310d8e9a96bcf075526ea7539ef167f314baa867db1778a50066a51fb778f777f018680dfcaff8031389c5dc53d88036f049bddd87146199a",
        "7211c4a6f86d7c5e1c9472ebf9bbd2adc3588a4ff7f6e58a2678dea63318426ddf5670d8b7efdeb1e65c2d5811e51cd24b14fe2be426fcd3b3d9dd8a8fe8adea",
        "1950dbd37136aa5a4faaa6b2753710621f6ac2bd5924808c24b0e829d78ae82936aacabe0a8313b861d66571f30d6ce1a9857d7d6867245a1382c482ffd50920",
        "90979d71059ed937c7c5f2cf98e9545f425c6e07109274e7fdecaefd89de7a2afa08e9605e308f0a7895b86b8938a3ae88c15a5227e31f060f88902fd5566ce1",
        "001fedc7333dd7678b64b8116a41fab8c9553777fcc7b2a0b931845336e7e85ee9e6bbf528131f1fead52735a500a39eefe102c7e48291f4c8a8e1abd5dad0b8",
        "ec9c8ac688af410e33264ba659dbc7bb652971831680ea2062576d394d298f58b3ccd9a1f39a3b40bc6c73609c976f71524efcd45abbf1a98b3f15dccf0b0b9f",
        "1a008b0480a4eb64d292db671d4f43f46fc57e077b72ad3ec0a3b0b63b320357a11418ea916038e9b659ccf39ae574ef8a8f683f1eff954788591c13022fcd81",
        "6bb2ea3e239b3e63b061566a7c0825f37dc4e90f2cc379a5bf7a2c527b7c06eba52c3af3c6e75ca28a139578f3992adfa66debe1b4516501be0f8f911848f837",
        "c8cb51ea177b3dd9d63ed99e73493e39e38b09756d9a2ab0818601061dbdc34b25c5f81969c613e7f014f611d335d12109b058b9cdddd606132e3287e5ac8c9f",
        "5762832a51b362af96578cf84cb5469da93cc84a29a324c4d3207065316c3cccb68404f2de96032e3796754384c66b005a548d721797af99b218775c21be9415",
        "028b9885b23573281b6254819af2c770ddd246712b61fb6da1b493c242e6a05323896667d5b63939c24e5bc5cd58e25c43cf864c628a13a0e6ca6577f49728bb",
        "0544e62059bdeb7d35900ee99ff9720fd520ece826f55a12e83af808d3826a9c198670c08142104f64700c15b9c00580fd2a32ac2662007628f765b20c2f6a0e",
        "9e331f94f300a9445a3a554e128142b82cbf6ddefec4fa36f39c4594fa256b254844099694e8484a8ab9b223fad9d2809e693e41894f470edcdcd6d30057c44c",
        "e7e91474411154d7cb3af70b299dde05326d372c60ee6b00ab6f0943ded345661ddf2bab8dfb62d106ac1ba47e51614b5da10a4a0faa8429724d1c1b30aa6ad8",
        "44f0b49466b767aad4665e4e774e5f554b0936becebdf323ca951ee7e8ab0dc55fd5ed553e54d9ba5723c546402afbcf84f4da8134c4ed3d276efa9f3a6cd433",
        "3d814090cb075b14b69ac5614e24e389a402397203ea18e889b2cf5de56747af8fb2988420f24ba98c505ac63da6448220d660f3fa440d990d1ee7d4676debb2",
        "02e40a3f0995e051f0371747a7788b0ab6c025e636035808ef5bc5408b7e810471b4bf2776eae8fca9f42360e1cd460f5177282eff4d0a017296a1ba8a23e720",
        "ef376d784a0065a15c04016d58f45cf881087f440caf8bd545a4f28ce55c28669b964ddbf03d60c5bceced004893ed5a1e84bd36a2fc966e428217843200b316",
        "6b6b5089ba36b786caadc7d1519b3eef9bff706af1aa3e48afb80aa2e718ac6e1430f8e59ba9c584822e7d3babd4cf31cdc06b7084868eba7442a6e0d1019e75",
        "5c3e5a24a7c3f2d15b9fe1110876488bc27b9a4573a89e50999bd29d43675316a2dfb79b6d094a531ac795cb1f74827d71e101892963490e78726174f6c24e53",
        "6f1955075340bc37d1ba919acd181cfd8f36332f7e189b37fae01bceffb397a33606121f08ffdfe4c14b5f330400859a9f7a0fe320533d3d36fc22d2540a5b9f",
        "a9b159065acda6e2eee883409f5dc796afae042237ace277514f72152a480465ed44877cc5f8267434ce9187fcdfe8f8a4f69314a60815513a6b6c63287f5e29",
        "6486a74d95f54812a76071f6c6344ab6d34df3da685ec70dc78d9c5804b4ee3c449d9e68a6b52491f8275b838c2cd9102c3c223a620bbee2671edbff2611594e",
        "e84b03d611794516dc8ba99b3e90c08ecf1eb1debb3e25bf351fa0911e0c84adaec84e270b0123c355ca08098836448b6d6db28b8e56fff1faff9cc8eda83580",
        "d4426e18470ca1b94106ca189255cdaf4c4e6c08bde1e7f66e3430d0707b3edc2851d5c30bf32ca1c654fa3fa4c357c722899ea10985498f7cba4c07201daaee",
        "5a2661aba1f4be798b55c0d99f18bcaebdbf32e7eb0b64bc3d892cb345e980f3398ce9192898ac947154f6f20a85b38a4bc9daa37a6b446fe72928e6912494bc",
        "a3a832bdbf02499930949d2543b605feb5e368dba59ec97d1ada55d79df455c24e2210cf2796d17f5f6693faf9e297bab520f7a842c1ea0ac8aee571bde465c5",
        "f2a20319785a6d0358f0852fa6241dee3696baa35dca8fdfee9ecdb2fb05856c88f19c90e14768578c718788c1b950d49908d0e302439e926a8cfd04c5e859fd"
    };

    const std::string m_7000 =
        "8a35534a4e5f79737bd18af9ceffc44c224765aded7969ef3cd725beab8ec3713563c6eddebaa4c29fe95ef51265defd102047f045f6c9e6ae5359a72f5058de";
};

TEST_F(Sha512Tests, Simple) {
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_empty_digest);
}

TEST_F(Sha512Tests, ResetWorks) {
    EXPECT_NO_THROW(m_hfun.update("Hello", 5));
    EXPECT_NO_THROW(m_hfun.reset());
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_empty_digest);
}

TEST_F(Sha512Tests, BasicInput) {
    EXPECT_NO_THROW(m_hfun.update("The quick brown fox jumps over the lazy dog", 43));
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_fox_digest);
}

TEST_F(Sha512Tests, ChoppedInput) {
    EXPECT_NO_THROW(m_hfun.update("The quick brown fox ", 20));
    EXPECT_NO_THROW(m_hfun.update("jumps o", 7));
    EXPECT_NO_THROW(m_hfun.update("ver the la", 10));
    EXPECT_NO_THROW(m_hfun.update("zy dog", 6));
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_fox_digest);
}

TEST_F(Sha512Tests, Extensive) {
    int i, j;
    for (i = 0; i < m_cmp.size(); i++) {
        EXPECT_NO_THROW(m_hfun.reset());
        for (j = 0; j < i; j++)
            EXPECT_NO_THROW(m_hfun.update("A", 1));
        EXPECT_NO_THROW(m_hfun.finalize());
        EXPECT_EQ(m_hfun.hexdigest(), m_cmp.at(i));
    }
}

TEST_F(Sha512Tests, SevenThousandAs) {
    int i;
    for (i = 0; i < 1000; i++)
        EXPECT_NO_THROW(m_hfun.update("AAAAAAA", 7));
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_7000);
}

TEST_F(Sha512Tests, UpdateAfterFinal) {
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_THROW(m_hfun.update("Hello", 5), std::invalid_argument);
}

TEST_F(Sha512Tests, DigestBeforeFinal) {
    EXPECT_THROW(m_hfun.hexdigest(), std::invalid_argument);
    EXPECT_NO_THROW(m_hfun.reset());

    EXPECT_NO_THROW(m_hfun.update("Hello", 5));
    EXPECT_THROW(m_hfun.hexdigest(), std::invalid_argument);
}
