#include <gtest/gtest.h>

#include <toycrypto/hash/sha3.h>

class Shake256Tests : public ::testing::Test {
protected:
    void SetUp() override {
        m_hfun.reset();
    }

    SHAKE256 m_hfun{560};

    const std::string m_empty_digest =
        "46b9dd2b0ba88d13233b3feb743eeb243fcd52ea62b81b82b50c27646ed5762fd75dc4ddd8c0f200cb05019d67b592f6fc821c49479ab48640292eacb3b7c4be141e96616fb1";

    const std::string m_fox_digest =
        "2f671343d9b2e1604dc9dcf0753e5fe15c7c64a0d283cbbf722d411a0e36f6ca1d01d1369a23539cd80f7c054b6e5daf9c962cad5b8ed5bd11998b40d5734442bed798f6e5c9";

    const std::array<std::string, 134> m_cmp = {
        "46b9dd2b0ba88d13233b3feb743eeb243fcd52ea62b81b82b50c27646ed5762fd75dc4ddd8c0f200cb05019d67b592f6fc821c49479ab48640292eacb3b7c4be141e96616fb1",
        "5e6812c0bbaaee6440dcc8b81ca6809645f7512e06cf5acb57bd16dc3a2bfc57dc2bf9e6d8941950594bef5191d8394691f86edffcad6c5ebad9365f282f37a8bfa3e49ad424",
        "eb1ecc706962558597daf38ae77a4f394db56527ea2182bfceeeb4408105985057c47b682d4e448d0831a4a88343e1c8463b1dbc0448b8b91e85d0e3ea07e223caf27ff13228",
        "419614c8b247ee5e9f4a540f7aaa5ca5b44b119f47ab7f494c05095ae5a61ab6b62c84b8b27888813ce8a4d4dab3ed7617c6bab643aa01bb1b113e6d48c3e1eeb73e96f96ffa",
        "ded2952bb56c24ea5c198e9f6a641a70c4306ba75123e15c4f5e445013133d824ca42c15720c7a8e9e8e0d2cce0ace4c82e80a579cfba4575cd59170fb3fd97c703fcf5adcbc",
        "e7a27a5681c324a71e963fee868a18a1b3d22b657e5959ba2c2f12ab58fde23affcbb717fa43d1927f965f37f7d004c6f3cebe06feccca053d11fd8563986cdded64585b904e",
        "632c053f3e1c8bb2610517acebdabd279da3bb8dda2e99085de1486615d78ab43356f3b7c7d34e91ff51e3c76634f4d58fa81566ce7bea65d1edc33ae2dc9f958280929da08f",
        "2955acf39866120dc7129371035c3f9236e2b292bb853b89e6a25f4f25c6fee910cd4b9cbef96b441169e913c9a912ed2b5511b5c90f6881c0aa0a5e8706d307c4c38883c6dc",
        "bc41f91474c3e3ee3f9b9374332bb52fca7a5643c0efe6882bea8f4cd5e3f24efdf54a7ec4f5bf1f889abe4ef02ce9b81156b18612da63f1a2699b59b81ad9468dca626438aa",
        "d9cb0aed8cb53a080025f63e944ecb45bcb33e247d65413bfb6f4b4cf3350f793ffbc85621579b98e27e47d8070e50eebc7b1c4673bea939bc94bf68d93b39ed9d8e5d544c2c",
        "572c227a089ac20f79fb3f0d7a176c5b7b4c8e1a3f9462b7cd3e212dddfb537098e7459d419dbf63608a65d5a5139a1859b45aa0e09fd5eccaf81122cec7833a98c0e58fb7b5",
        "641e33f6263c8d1a8aeb8c622cf3136503e82b62a222454926ffe1a3d9e41007d447d2d0f91aee9b7428d87574e6946b12c97c7cc7ad913bccf91511be71eb9d5942e81ca85c",
        "d986c164ee222679de15242e81bae45f444b9eed5520400e953ed24dcdf27798aec69d91db7050c563225a2e4e076bcfbe05941ef609fcc7ee7bcf580eb4dd41d8c47d715513",
        "d5a602532f4585305d2c327c5457178a5515b77cfdb782a382032144f96498a8dd8f52306b47b5f87eace4cadf8b4a1dff24609aca8b931be994e8193435232c5f52977023d0",
        "29b90eb1dd0a4bcc24b02366d51bb60bd011dac7a490355c7b930f8e8eeae22f1519f5474668acecd04276f86c2f63ca95aa3fd8c102b773e733f8eea06b8a267eef5dd7de65",
        "dc2b5a623e064feb7b2bfb341dd35607bcb651cff43a2823105c3fc2e1681cfffe316053df28c24f477283d193254dfc6cb50efe070f16ea7a858c27189445110efe061a9321",
        "b6591fbf5190d435284e24ed9f1ebf3d0d3d1cb9ea34e244261f40fc6926e51c0e5a2a27bac065b2d8f9af338f66d8e79637f60ca804ee877c04932a876a91d48b3d1ab73f25",
        "5f4f296bde0475cc79d39306e28d5b078e85339be6e24905f4a2f8a521a1a2ea9bf4c918baaccd9be222a50adf1a8bf2b5e7b32b7acfe0824bc3699bf50e0b521d829e048a16",
        "38a3bfb9cf3316cc331206e9fb48952cda4f258381d9220a94c6b0c0182e56914f046dc04dbc4ac20730318b815b0585b9fb2c4cc616352dbfc1aaf8f15ccb388a8c72c0703e",
        "92e5826c4b9a2b3dae75290e65202f41ff3cba213c939606212e9996780fe879d8e3c02ea3a37294c1205d302551f5565b9169a5a959477605b5b81671cecfe46b34adfc6c10",
        "1cd973b45a54f074df4eaf8641a0a3673352f77ffb55e925137745559cd645c2f97a2a64d8387434ecd9e0dba69e9ce2f58051dd4d7cdb7e1ab5c008f5ea38d2dc4769f6c664",
        "a7ffd5be1a4599e5f5dfe27f3a13aba8c7ae48814b709ba9a9b1051a6f97f502a2f701e03e598df0c1f9d6bb9819eaa1e70ac9ad4e7885d898664766a716eb39874c761ed71b",
        "240ac15d28dc6c310079840c85aad42e688633ca368d68404187c268d362f30edfd8e31187a3febdd3cbef6d84e4c95e265b523b5a4732e801367c858e954128b9fa027c5d41",
        "406ad4623d92775ebf667804d1406f14e7ce00925b7fe3a35f4aa52995f0bb161955e9bcf7fe5fd5a68a5692b9cc5b92b06427ce4604d7b6a7b514952f1ab7d35963c3738134",
        "8c4f2340dad26fb8905599b3c8ae8f87fb0210fe9e2daaadc4e4694ec171dbed6d086a97961524d5aba8291900be66fe783f4cde7ca0a61ef31eecc6be01a673bd26bdb85c77",
        "0a1da15e8fa2f737afe416cd3825e0a85857d5d75daeb87933fff57e87124b17e4b994b6b745b7bbf57c4aa1be3f00a9ab3e44a5be9ef30812d2737a7e8db8dfed826089cab0",
        "aed74c50ac3c575092a38251bdab1e62d0c2784a4bc0ce65a655261d0113fa089ec0d7c6f65926989ee98fc29839ea1b0dfddf2da6e4b0a0395cdce48c5d39139c9dc6cf4c3c",
        "d38d1d5564341e2f5dd8a7a687a491bdc58e3b4eadb9af4b1eb89d69bc8fa28f2e30f2e0c84a99865ae70bc0419a8c16c0589dc61492abad51e79ab343abb4715f504ad6f7fa",
        "1a9fec73d01f3636f89758e5858b5d8a78a1b121411b3b25ea11a3e1084ef3c06d3c91d714660ebe01951078869134e5c82819a5ede31bc5001f4615a5e83284e306df8a1b1a",
        "6ea47415360c5af446748bc2bb1b7ee58fe0abeeae382b13d95572e5e6264a3b4340a9e719202b3f19f0c16443a8e8f9509479a79804a7a73038e4bc8e2fb5d32b4c2b8ed174",
        "c4cf721407607435c3d90df0f15c6f1c0aa52f8adb0964863832bbaf523bdc541bcce66b33ff5c80c18b3785d65f29097461ce2e41b1fb6c39add05b4b79e601e4bac989c2d5",
        "89797ea1e10803e9df2bcecd530854eb1e4ddec4a878bc6a2054caf160dc18d595992822c973a32f495b00ef5a73ac875b1f42a8877b4bc9fbe08ce3474cf073792e74fb07ac",
        "bf2a0dd1139018429de7a23d82d5def24e63606002152567d13df3b47a5f25432dcb01d3c2b3f1afda25103e9103da090b85d7acb2cdc54b006836612f8b986d0d9f07ae6407",
        "b4b7238e91f58cffb88d7c87802372f44fcb45e71f50208fcc4549c59b701dca7df60c19b11a8d31f35c8818497a8faf80100b5629a0480220f3ccae60771228880226c7ba14",
        "fde9b951c3b19cfe83c1a19e6245c9bf5e0b721a73021783072efe99d2502e940a346cadc33e26e7f9bccbe2916f358d3bed369751c7e038ddf52e6b7c4547260c12a6fba67b",
        "1195a3e3f277542d513c864bec5ea58458f9d8bd007a4f4e0792ea159393e78a703d42f0df8080e4e79a29528acf83e8ddd3fe2d1008d503d9f9538d223284cdc9a42a207571",
        "356b35fca8785c94bbc65bb7c77a046ca412c2dc06ae33c51df8eef8109dce036e04c9ad9cdccc0cd8261b3f988fcb57211e2e27f624d750204249d6b585e1370b61dbc8fa08",
        "02f9fbe6792a5ffd6e4dc1c501d7d611ed7c5b4503ba6841ace4511b5e07e3e80469d95753c7ece641553f454925e3dbe71ecafb68a944990fbf62e89da3a17f1175f741c61b",
        "01ed5078179e6804731ddd00f8df2adbb6b6a8c3c8d869327f53dcbb88719ae03717efcafb092bbca42a91db5c4cb19d3df18615a3ca207271f7952e7300662a99dc6d3491d1",
        "fb21fa8a0e65dab3f45199f6d3d5b800100661c4d05026cc553b08ac67ab8bb12f139fa35551b6ee154d2eec9661ce0185104740d41922d72a7171b0454e7c07b8cc1668c684",
        "f98aaaf19fce1b45c289eb50ead079f8ec6d7196d5f537d1851bbbbe670d94138fa961a2386375aadfbe07c30afa2ae8f1cb89ab47e23ec4f74bf6cf736afb2f03906e5d0388",
        "4c17ca841281a3565261e3285e600d25f12eed71b84bcbd8e99575af4a75d24301bc0d63904d65c951ddb5a07c4a747d8dce9dae1d2871c5818bdf223aa8beb6b6b39df05264",
        "df0296b780fcda865b23512f96f137cff8474d8443bbecad27b29debbb8ca7d2d90527b8f94b03e99c221e61abb2a950db3a84acab42c229624307a0fc0e83590de0cb790a69",
        "2d733723fe4c19f9351858fc5a235a4a922e558457484ef6bf4a0eeab4838cb45d96482f9a861524f6502fb340d755e160c6c993470882a67c41de85acd2088934fa8348d9a4",
        "40b880639c5acff658a5f56302fbbed1c91fe8ce4682f24dab5450eff996259b554d443a149b767fea13a0d4859b74c8a209252d566d2d502559a4bbc5175f784bd7201c7ff1",
        "6e37145a1a26c890eb191e5be846d27abd7dda5cd74826a8f712701ddb1d57c2c958d6107e303dec93c493fbb6561388cc18ee76bfbe948287715dbeea6f479bbf3fd19fbcb5",
        "69455f4cdb01a2b1aad58d5b6df457a0b64a6d594e4ac13e6c8adbf26684656f9824ebec089dd678561f2ad5d1c5ba4656b78794014465033d3c83531222baec7be2b46eda09",
        "27b54f5263493b54f2e9622f541c3bc16e2a6d4b8370ed45dd417494b71b5ee60f8411c876221dd86ff39363ca350d50d754b0856e8f16c7e4ec49bd893a144ce71fcce97d8c",
        "c53d225a22d7aed52c128ea52a5dbae43f4e477a0d4a15c06589dca3c343d550caf76925c8148d7cdd88452b48c2d2497866ca88616e6282bd873a90dcc39030d8b60db65502",
        "c12d5bd8fcab435380f0111fdf8bea00dde92b1a90d537a4232ffa3b5cd0dde865ec0e33124e32cec0b59f0029b501b7cb790576c9e33a1dd180799717b6cd8ad0e9d27cb3a4",
        "b3ca9a543ce5c1f835587bd03637851e91086439a84028b3e5d41c4669b8512f0884cf2076a0058aa6ecdf3331bc86f507b92290c25cd1f7c558e4c5286b887a43df8a33098e",
        "87338e747c685f41c0c1dac20d32bb000fcdb51c5f7f3bfc402b8ed3101ad163db14b46bf73f0796102e81a4c87e90b8c94e293ed9674de0e35ada44550ca9a1acf8daca24e0",
        "ea7da4b4a32ee2636a435f10c5fcd9b2ce6e1ad9022f998078ad0977f95b23ac7d3756a8da198493d2124ff0dd23060396ad1072a18df47df0545f01178f9fb8dfdb773c040b",
        "dff9244280514f9d18ff63fde2bb01f46317607daa706353982f92a0af6b9009ab7d002f894b8d5396ec0eb0663ab396055250942b21ec4a3b91b1cfafa4374de8e01b371d43",
        "567ad852811837a2cf4465b0349394c196ea9aa1043bcd1f474fe75dd4826584654c653817c4650fb5af045344fa37848ae2e3db4636b9b34cb2c553743cd1bfedc2d9c8ca91",
        "2e9dc63c90e73e2ce1e57cf2bdee22c20924efc05ae783e915adcf8962893301362443a8fa998812634776134a946d4dca205d2b421650b0414f2f29ec4c72c94eae4fb2db0d",
        "b449bab6ca8584b8408cda897af2915246d4a63433fb42ddb02227c216a9e8a8e0996c8ba61a6ff6d83c5261d10f773f5a7465994d446a30e2070e64d17768b1965fef7e513b",
        "380274329d0f8be672298269851b089553e74f8d4cf7fafa89129d25e62c301234a4e9ad3c6a4206049351759c70057f4ce1f4b2383376cdd5e2d17ed76642faae6605f7d401",
        "774a9b4e2a50f1f3df131818f8841162649e9f25f13b12b9be00cd1bdfe4ebd03e5131ff434a853deedba97ec0b366df1db97f92f4ea7171566102e53031fe1d80a2b137e55d",
        "82759b9fbba659e17c179486209f4e16806e7d099b6834ae4ef3f963d11dc37f8dc50101b6b95326e821bcb510328b10bd8dcac3bc85bf12547a01af6be1986144326167181b",
        "6847b857a58638e5552b8f0285bf501c03c41d178efabe121e1e285b22f3f411769b919457cb85ec1f5470f953fa8918a4414fbd06a3a159734dc6c10873d78a0477eb955d5b",
        "28e4bce37b08443fd002f217c2f2c63f86c217e22296d557b40c986cc9f2fd857d4b689860e3d63dbd344ecf1e227fe386cec2cd22c66729c909d88c3cb3a809c96b83159552",
        "2c275b7eb5c4263983306fe18ed04e1e454543e4cc14f21a5b64ecd3ff795c62d0d4bdeb6c223315554035f76691c160f0c49df6372f0eb2acaca877853c00db2d7358c650d8",
        "5aa6467a57ae475086bb68695fed54578dbb93265c692db5fe66b28e6bdb4b34e4a7cf22afe64b2f2d1b906151e01e062d3ff648499be46d5a8ceeea52f3e5e43ce87344b1b7",
        "910880f5920797b2b145f3a021863c30515d9133787797c750cbfc5a1ad52073836c16f4ff2b181e5b80b6fe1f42023f5855ab4b03fa0f407915b088575a6fba36ad82a9d8f1",
        "530f0e0f9d121cd2bb27b9a598f7241239c5bb93a3da99e160690cf5ce3b0f1edb2a4c886598a4e95eae64417b73045f9a3e536e4dab62e31088d02293e5892d7539c5d9336f",
        "ece45b2caa66d639d3fe18fd7719764705fc579251ccc8a6ff4ffa9a9b18ccf5741d39c4014d99317bf891a0368ad11f64269ac328b9b69db7bbcb8a788c4a6c1391c3df227b",
        "c68f1ede5beb936cd05948f5cfe4dbef2ba45488f224e228b7f418674d10c4047c9fce4ea44322bc92dedc7efb688504542571828ae2ea3e2f408971979d02de5f9a25119381",
        "2d2240d79199a70f1e9aab7e45a549cab33dee5e165d5f398289d06fa4893e4281554914bd0a703432285808b0b840656fa0fde8bb1a1105fb2860f110190095ed3e4e23c92c",
        "41b5d5aec302a29a5bfbf5837b340c5ad0b41215606f4d823a34d890e97619563d20cc0a9a73b5bd5a7987d423d11cd73b6805d85b85762a803d82cba9a058ad712cb8343c69",
        "1e3b424dafc4382c728d052da084a65e3ede80331eb8e86ad048b9d436ad772e655c10084eaa6f74569337a064266c02b5d58f0ccdd392b5881b2fd38c2b4155f9d68308e946",
        "13488d9d4dae1b21c587e7fd42fb387c919a8b4c5f12955ad227c8889c6a14e5704a7b4290e8b5d1560b6275fbaef5fb4ef371d86ccb59ba0a4f070ef2f2f83e2efa9cee1186",
        "7f0ad736a60dc767b617494e40ed0a5c3bef27a8e29d08dca6be4ef29e94a0f7c8276caa89a4e46641cf2cbd2482208ad594297735042b7b57f09b04a04d930826addda79aa7",
        "7c85acfd5a2fe258cf5fd31c541f64cbbc49f82795a590bca832a8da73e33f0e744d424e79a1964608b9efe0a0b4b3cb9db7d1bf24c090727b273be14091a912c9096474433e",
        "947ad5ffc7c95cf368838b69c9974ae0e29fdf2b7daba87168e0d0eee12c4ec8933d75a3df0555a9acd556bf017c25ab6ef00c333be0d24ec036f5d5cba7cfdac69bb6cb99f4",
        "b0fc6016c13ce5b05dce38687bb2c82dbe5224652651e9d415641d85a92e945c23703d96769746eb8226f44f588dc2f6b807e48662a94e87b5cb19e9d60d8196ece4c10886d6",
        "9b7eddaa880a2cc273ac46e2d6ba5b0f539a2c54874acbf639ffb8f5ad3a1df3f92a2f6a426be59b0426ce9214f0165dce7b3611cb215ea9f4ae46cecbeb84bc6bb8bcdaad97",
        "16f9571ac56f6f83fec35f8292df743f6b3539a8bca8bec3601f84ce941e3fea00a8a561034e64f80fc9ed49608255731d4293ea3910ec8d083d1d8a81af142377e1d8410734",
        "ef9d142c899022cc72a23aacaf71f25dc10942c1feed258b022fafbfb3578ca82fa0f5e813f6867fd128c164f29cbdaaf2ffe5a98bdd2a2d3a7d4decb4a7c9af16967702c722",
        "51e10c2a2b9304a4f94bda99c642d637a636b72e57bbc540140cc87282e05812ab3d93c4c5ebb72b96a7f5efca0d2cefbbae419ef3ede3f3cc9fd124bcb771b074eb7168bffe",
        "b3b144585c8697c9abcdfe8de2f75de301d268a6176d2c5bdb524ef1518a3eed34f2066e31c243c2a80428f48dbb4569d64d04701fd593502cff3de9b2fd3aa01edcbf1e4b57",
        "8ac3459abb2b3c44c90e74e77ce85ff5144b5023b672ffadf02503a06f440367e025d46ea83ccb07c6b3dae58844cdb9e5e9baf1f38178b98cb3b4cc0d456af9a2029c8be556",
        "3f83aba3a70e56d61df7a97b0a1dae22af0df55f022e05edd0c875dc2509cbdd623183f6e2af586bf2bb42402d8d2f6a27aecaa584019770232603d9e4ffaa25a7f25b59f5e4",
        "f7514b6a952f2dd4a391b503d46e55e4112bf3147b68eb54ccc91c4f11b60123d6ad979f6dcb1668b479171f6c7b6df831e5a876a87e88e3e3426efb67b34285207277db3b2e",
        "5d77e2325fafc9dd0b201fad75bdf7b8d51bfd3af744497ab083a6f04b1ec7f66f7d6ee9c70afad7bc4c434e3af4060b6458fad08ef08e54d4c1c215f55b82be9d559c159ff4",
        "b0b9be1e31368491c473979b48c4d2293bbaff7608c8fcc8f6755470922902972e1b9d1f3a156f1b2451fd961dd90f9d58fa5505d4b25c3ec33c03a673201467a978cca4fa4e",
        "2a651dfd260067869b004a28b09ba2e02408e6b3be58a3042c9fbd29e98950e4b1cbd7b709ef3d2f4983d87653ad7045e9cd148f37c413dd5ad41d7ab286639860bc5c366428",
        "59051864b040da5d8a672fca469c0a02aa3a86e8277c18870e8f2ad19448b076c3de823374e4448c88aab79395f3be3c33a06f56832f94066f20f7f4fe0e11bd6137074f00bd",
        "d942bbcd612a5849999f5674a5c0901ab070fae846ac3faafb04f3b799eb60eb9144209aa113e4db1c2b88d9b3317cf6709be2b13d2849d7e764761cac3f4390c2f31bfdcfbd",
        "8804d3b5b5aaaaa3907e8032274971fbad6563adb63f5df45c25c04d90e8b085381b21f951c177199015a90841f920615dfbf14e9c7d49b867b4e16d3479cad97ed03f70e0af",
        "7e95f7bc43ba5aa1d1a6199926d3b3f1ebd0c4a2525c63c90bc75b138339b7aaf4b7945ca74a968853f5583a10c074e06d4f72d753645041c8eb3ef7e2cbff8acd871c554278",
        "9d2de353da6c665d0c9e92ee806d1e6212ae0fa0bd303c979a8276fd9584b7903da25b847f024ff1f5d57932359bae5eba157884f071cec3041758f2da809a3fe4d0f97b317f",
        "25f213f2b3c632604b016764294d62f0fd1301736ff7e6cda3b80f682d97f846e337dd9ca2cf495fbc22f4839edd66e41b1853675939d447bdc2978e249618256e48d8666b10",
        "2b0d43c1abfc5ce43d406ff5ac6aea48e5b9db4eb63a1205bb14a523359d5397df6adf5a30196f0074f1340bed448fd8f0b94d37732ef03b19778bfb2f1db70e7126130e192a",
        "81ec4bfdf0fefd41c9e49321758a73167dd02202627beaba14b766a217b402b4581b360316af7619f7f875f18c776e88e96e5c3bd0d58e640d6e5b4d40669bc4bd46e6b993d5",
        "c466cdcc5ab24137d8f36c0f5a78494f4c2a39b37bff59f9aa52318969592803874bfdadebdbaea0297299783f2af8d24473f6a230aea225f969308153a76d901d016710c775",
        "e1f809c13f03ac3bb125fa5634fa4633955239cd8da95220b778b7fcdad185335f9f0866a87a9f2d3779839a5bdc247c659e05624a2bbb854df8333782017600ce9237ab1df3",
        "205f47d0a995fd6392565c81a74d59b69403d24f98d886b581aa638fd86e6c8de0fc2cb0d33af1178866b02e15089ee14b2bc98de58a107dcaa99f25f84e0da681c236d68e0f",
        "90c9815caf8a96d5d861c672546f8c73ee06c34734554f90319ffc17d1b4346f800cd2199b11b33ce2aebde2c6d0b34bb4d661787320a4c41f626a50de462408b7234e60df02",
        "57b5b1a8bb966c20aa6e7ff75b405b890af4820f851f13d6b1ade2a6580ced32ec004b554a41ddd97b32887d624161fab683f49046c2028fab14e21e2ee5dc528dc38ea8ae2a",
        "7a00f9c7e73391044cd70e2b7306d5b84cb03ffde6491ab18e14b8ae7921e1afa332bb9beb4b369338478a3af6ed772e6cdcaf67d7cdcb5d2bedfee0909e456d97bf3e1da681",
        "7204c46e167fd97ea56c87ddcc3d6c238f7ce053509ef0a270114ff08374fc054a5ef6acee4d15328c62a2b1b494a4e3eb46ce24d9bca65c2c441232659f552b040fef2df453",
        "38bfcefdcc759f5b130ea32557b76015dd873cad2a4ed3796406d1d52dafc4d0fd8ce35ad15d66e7760b761854b8f337e9bb1be9bd943ae54e1ad3c63f136fa4f359e4b57086",
        "e00ca23c9a4d12e6970df40eda667cb3b5cd55555e147a419ac3a85e0212374e4bcf52579f52e715b01ef0f481a890f0497715c014d1afba8c7a432a5a3ae72d22e5f4bac250",
        "5b62155e6d59615e012c125a5dded3c0e90161eac688e73c00c773fe7ddb9d9215032602a9a836dd5b2b94c61947cd80abc8aa8249d091d859d3751010cedb32ce2c6d743430",
        "3b2a8ce8a0fd2a456c947d84073dbb32008d4e3736202aa198bca0378eb3be26d3a318d9d13362126b2083bf87ec9a8a204ff7053373c25ff26b46b2ce79521667a08e90d5ba",
        "95912943ffda52ec08d061328dcba32b19b00af7ee0efa01ebf4a32f9b31c47c983f81d088f0db648d2736e0f31e6d52ad5ae4f46665336f8ec3a12cdcd7a80637b59c7672ad",
        "a4cb965597426bd08157677d6614a7618c1330f77d40df7bddd9e1ae4ee419d86a216f668d58d43705076f779819e14f6e1ab8c6639fc9d8f090a4493663be5adba5b4796f3b",
        "b4e5eb161f7d4075732f32197a2d38efd5c1efe9066916abee0c302af4b3a4169bf5dcc9e8893f75a495bbf19edbea6e94c7b625fd6ddfffd1d73dab4cb6f21a2c1776922195",
        "a97785d8e930e2f28d9a7326c5f7f0f06002ec0c461b6f79001bc0492f142cc8b4aa0c7da1be3868dc229b2dcc3038860cfd060596ccac860283c1c0135773b936cc16b47073",
        "25fcb256dd510bdcdce029474ed7b77e9d11e602f03aafb42a44fa59bb604e179c22521163c87a534a73dd5219f1a0b7b28af05bcded09f53f1cedc3f72048a30e12cb718221",
        "e3e204716aa55cdaa9d15dbcb430bbfe4f2894c16063ddcb12b1f22d12c940b05530714e6c01595d25251dc86665047f2d55569e3b23e8cf2a1382a87de303d90551a3be305e",
        "9a594ebdcd7ec5dbd05147049a18d25546c265bdd1c681a9f674a6b1caa64353a517574edcdd79e2669b9a2a03e073475f126cc8e2023970b4ffeecac253b132c6a72aa5ae10",
        "2fbb219d299777207c517db8c6679a31141dc1baa6892b760248d49378cff01ee1d2c4ecd6b7dcb0c86db9ac50ef7c8c589729ab45056ed40b519fe79ab705faa156dfd6bef8",
        "cb426d153b460b7e92b218001eaf03cdb7a76d127a2fd6c9f6c8a26f308cbd1fbc79a3a392a780629313ac15b606f0a19c94a339ee04f8b559e8710de734dce512faf456e8b8",
        "654373480e6155ee78ee11c4cb60571ce951bac4aa7658a4167a088bcceaa90af679fb114f2eab47380572c239bb00421918a0213fce79538aa58e4397b7d79982864b080b48",
        "89a77126d8027e5e373dfcef28d8ce63070339c23ef8a9f0c06cd7868e539be1cf0587d439e797b7b8e21047716e72146a2946ee53a4be4b216d223310cced4bc3c4a55e3710",
        "04d56a42811f7b60e35e3346280be782b195fd86792f28b9b1f96514bfb2e1f8b2ddd752417161d7fe2180817b4e43d67ed2a2e818b300ec77b10068d597f8584a46ce9da06a",
        "3bdf1b24cb58c6c442b41954232a45a63b1a2fc9b96de25891a2b12c6caf5a37ff869674d58ee45c35cd6ed1264ca26da8a3f57e1603b3d0042d4dc7b266c81a15b763c1301f",
        "a597d8d595ca28ed45ab43e5325110906473066352047d316ac183610dfaaf822a01d1779c1f393ef9090c35ff0cdd72ada8cd541b4c19264b5f979593669ee57e39a9bf227c",
        "de897a80098f31b49839424e5a6a480ade6c71635a06fcc3f367be85583162f5fca4ef08cb954750eb13217b83e8bba6b5b52e57ba38c0b777a2b350158691752c2f2e3cc27f",
        "c68f1eab765fd163e1163aab4c77ffe0549fbdb6535e5897cad0e0d114f0d01cdef32de7bc379fbbad4d9438d890d33421194697737b33127577f42dc25dfe3ac3315e59c419",
        "29e6405e798be65f2704d1e8b1a3bf994fb5e9e7a9bf6bcf795cc4c08bd4defe7f6b8ab706d4e5e65856e448538af436001ea4327407a4524fff7a1c0fba517a7d4227c3f5a5",
        "56b86b0af29959841e863822f363a5d42d4bd4d533f90a40957447d81418bff7cf1d9e81b4e4c6640b6f924fa7c0534c289d4469968f874a5194dd345ec886e9e8c3d174b518",
        "89c01685e1a66c2bb31d1b836411b8bfbc6326c05493b9728d8a9dc2db9d45578929538afaf4b9ed249164f53d981cac4aa8ae54cf85f57d204b18cf3975533f1421cece77b6",
        "a80808cecdf1c95082b50828a18f31293bffb8979c0fce4c6a73c12dd6a1f5c5d596403651176ffc5da6a4128e98e8f9f82733d36a4ae06b202c1504eafa1ddd2b6f8436784e",
        "1a41151b0aeafa05094c47b52d621f35ed4c2d144f3e1fecf139ffdf82c4d5856d5393c662671e027f50c1840bfd78fbbe34037fb4cead29818ccfcdb968433aabd2cb97a865",
        "b877e154e6cd84666acb5e4f464f3ff7b7b455983e26e082e9f63e8bc8ac1efcc9e139f34fefb66a50ee7060560fbc849b7091ee52b2ce481cb3fdb0d4a4004654ad769aaafe",
        "94976a21d05d09ab7fb2426086c8f2700e7699e006a191649f5169f2b461637e208cea5d309e482dd89e017fd027a293486ecd6c0907de96eac59efabe7af56f0a8ca8727401",
        "2da71130e57658e9df2e7b1f43a54c775af2cdf5bd74f1e8471209253c798c9e09e07ca63886a5e0717ebabf37817ba1fb977f0a5ec28bb1e4e79940dbbd58a196d4b54e48c4",
        "1a0cfc8d738f925519feaca5206ec1f6f59121b807d102daf41b3850ef5bf5d2e0d4c400aa99674e3aa7de6315bf970c997990eaf7015fbf2933d04643a823b0c049ff7e62e1",
        "6f264d567d982be6d25fb6bed656b31fcfeba29bdfc75ca7bc95d7e676a55ec6c9ec69c874ce976ebe2ad093a62e906c74f1fea3df2935e75dd3fd2e6fafd8809581861bd3d6",
        "1acbef3748323ea984f2faa0042f957de757964d0bdb8dec7d31a5109a24518996119956d833121839977db6119856a89fc0298c00457ac675367d905a18402a4287fafbaca5",
        "e225c7c85e2c8fe22821934b8a9f6d0030d0b5ba2731acc3ced8241bead5199fcb643d08c0e3efad598bac073127ef8a6298a6a74fff5a5b2cdc22eb3799c361bfebc3c06f1c"
    };

    const std::string m_7000 =
        "ba45cff00e6cd264e3f447b7b2a613adfc1ac01adede847341be919c983a126b1158fd4d37fe7658a5b712461c358d5817af009bcadcb17d6225919af538aeb96607debfdfa0";
};

TEST_F(Shake256Tests, Simple) {
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_empty_digest);
}

TEST_F(Shake256Tests, ResetWorks) {
    EXPECT_NO_THROW(m_hfun.update("Hello", 5));
    EXPECT_NO_THROW(m_hfun.reset());
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_empty_digest);
}

TEST_F(Shake256Tests, BasicInput) {
    EXPECT_NO_THROW(m_hfun.update("The quick brown fox jumps over the lazy dog", 43));
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_fox_digest);
}

TEST_F(Shake256Tests, ChoppedInput) {
    EXPECT_NO_THROW(m_hfun.update("The quick brown fox ", 20));
    EXPECT_NO_THROW(m_hfun.update("jumps o", 7));
    EXPECT_NO_THROW(m_hfun.update("ver the la", 10));
    EXPECT_NO_THROW(m_hfun.update("zy dog", 6));
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_fox_digest);
}

TEST_F(Shake256Tests, Extensive) {
    int i, j;
    for (i = 0; i < m_cmp.size(); i++) {
        EXPECT_NO_THROW(m_hfun.reset());
        for (j = 0; j < i; j++)
            EXPECT_NO_THROW(m_hfun.update("A", 1));
        EXPECT_NO_THROW(m_hfun.finalize());
        EXPECT_EQ(m_hfun.hexdigest(), m_cmp.at(i));
    }
}

TEST_F(Shake256Tests, SevenThousandAs) {
    int i;
    for (i = 0; i < 1000; i++)
        EXPECT_NO_THROW(m_hfun.update("AAAAAAA", 7));
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_7000);
}

TEST_F(Shake256Tests, UpdateAfterFinal) {
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_THROW(m_hfun.update("Hello", 5), std::invalid_argument);
}

TEST_F(Shake256Tests, DigestBeforeFinal) {
    EXPECT_THROW(m_hfun.hexdigest(), std::invalid_argument);
    EXPECT_NO_THROW(m_hfun.reset());

    EXPECT_NO_THROW(m_hfun.update("Hello", 5));
    EXPECT_THROW(m_hfun.hexdigest(), std::invalid_argument);
}
