#include <gtest/gtest.h>

#include <toycrypto/hash/sha3.h>

class Sha3_384Tests : public ::testing::Test {
protected:
    void SetUp() override {
        m_hfun.reset();
    }

    SHA3_384 m_hfun{};

    const std::string m_empty_digest =
        "0c63a75b845e4f7d01107d852e4c2485c51a50aaaa94fc61995e71bbee983a2ac3713831264adb47fb6bd1e058d5f004";

    const std::string m_fox_digest =
        "7063465e08a93bce31cd89d2e3ca8f602498696e253592ed26f07bf7e703cf328581e1471a7ba7ab119b1a9ebdf8be41";

    const std::array<std::string, 134> m_cmp = {
        "0c63a75b845e4f7d01107d852e4c2485c51a50aaaa94fc61995e71bbee983a2ac3713831264adb47fb6bd1e058d5f004",
        "15000d20f59aa483b5eac0a1f33abe8e09dea1054d173d3e7443c68035b99240b50f7abdb9553baf220320384c6b1cd6",
        "1dd0ab6c4babe494ff4370c53a16427c244f8d45ab0d12a82a014bfaf948932b3f2ab0fe8c9dfe32af8080841fe00b36",
        "3555ed8a634b235fb07a691e1934b3e81228c859bc1c17acdebb4bab82cd63f06e17caed585533b4615bc6e3fb2e0bc4",
        "78f27d6e5727ff2ce7bfba5d7aeed27def619abb73e779771130ad0851d748db6327456280c3b5cfacad0d8ad84e108c",
        "d18bd26d537c18b60fcccca2ecd3c31fe46064bc0f3f5a3de22fdd177e63372fa10e0c19c0c7343a2a35120867c8b420",
        "c7120e3a4d8818baff8c8e7882bd6fdda9b1bd211e5863d8d48c74c37e1340432efd419cac917261830569a5f6f3aaa6",
        "a02650768951c2c7eb85ff2770ab161f185fe98467b236ea622be739525e5e58940cfb5d68bc46638a5496b7c147e9bf",
        "306c3c623a6cb058b50c55a18e9b163daa6969ff6cd3507bb51a6e1f3b33a429dc2eb2699d5be7ad44218886b2066f54",
        "6d7f3ff1a169ebabe42169e6f0af89a0b87c2e61e1ac4e8aafa2b3c60b5a0f5dd7961f79b6ad0dd9d89d2c9bc28f1df8",
        "841fc32760dea18c83c031019dfde46355b607fc05209c784f6280e9245432ba06d815867bc2ea4102cfa7c691c29ff2",
        "292237755ca7cad04f81d31b8130a0f3313a56a5f0f97a1833321b3b64f70da3d5a5061a683766943131e58a92fa2954",
        "c32a631ee2ac8f450a2ad309a69b893269cdf727ca82370dcacb5064751467f03b1ca53ee27ff64b85531342941ba776",
        "5cb708328ec4ff0ad02b64f357caab5be94506fb1edb016caf99f2f7eb4f86f6c64aae443f2efca0de285de1d2168eed",
        "00a37fad4410d3d658a21ce03d024bf303151538d2e45888a69ce3bece788e060f37cf6260578d82c43f97617e6189aa",
        "0c71a2359bdd5700980390d20672b163807f6913f7f36493fbd4cc07c1347d53d1ce0ec467825f827a445255c01ea9bb",
        "2c1f4c4f10e026e646b6f701fb277153664e6f1c698bac6f347f57f3481bd64d68ff822fffa9cd86e1756d1d880ab180",
        "4eb06f7296056b91d8d40a8120c5f245793e0ba9403743facd2cca17dcd7ab591c33580fb67095b6f2dee0ce586d1358",
        "7310710f71b35024760adb1010154cf0c171b2011c51424a85e0c29f1ae798c9c766acdd93cee5033bf100d10ebe8572",
        "6f36ce7749e19706f77b34a768cbb300d2183e019cc8792f73fbdd020a90311c200bdc8f502c911ba25963b6e997db6f",
        "f73b2284d56318a580d870dd4a87e597266f40683d5112ddf178050174cd634e7d53b41e65a7a886fe3f7fbdb9c465aa",
        "66eedac98875a1ea2f6b81915bf408e192ed3bd12aeb909b12b24475a72c0e37dc2b353b94f79af7ef01a96cdc35fc12",
        "51a19245ca3da8f38ebfb6e6efb672eed7d3e44a2196b4f3ec1a800a415f1abc08054ee4374bb755e4bdc06fed397f2d",
        "8676dbcb34e97e5c676e79e491dcde3b42133f642704aaae2b76537c3a6c11fddf37ba847cc0183d6b6bfba5fdb864a5",
        "b8d23c88b7182d0f1c72c5409b838a73e117aca0e4c3987a12c3119855af17fb52cbbc2130a515aeb69371c4f0bcfab4",
        "764ed63fce81f83cf09c22c968420cf4cf6f38d9589d272bed0c44334321137f1cf84692d591e1ed4f15f70eef2dee44",
        "1d7dd7ca4fe357d17e74dfc66aec47b840d642dab1324708a3281402ff8ccb8040dde525b97ba6c962bae297abd5944f",
        "c2bda0bba1f91fcb255d25bfffd859030c761ba1e1fc9f43e10b2e4a8124f85f89e543b7ffd1363f2698825ad51bcef0",
        "391486fff562d0d4402598c4d354684cfe8427b61ce2509d420df4a129097797779ced709417b0c089e032240a6e7a24",
        "5bd79fe7950a12408dba819040bac653dc63a1ffc7eb23c689aab6dd789d48d5d6defa22dc9e16f143032f1c2b688d7c",
        "2163de3e2fc53bca5ed2e577efacdb74e11a02a5d47ba145d7339fcfb1abbd446d36da0191e0cde947b5f006e2459234",
        "7b8826d2c9f3f2b4bbba732779ee00700be98832b489d9bdd4fd59cfa7ea66a968e851d1ca9dffc2f81325ecac51ae96",
        "5cf7683c2bafd8d9e5eb21be13d7bcda6a2d8e2e04c251e5c1edb8671251e291b6eedc407cad3489c798b7a62123697e",
        "6ba012d4a1394c6bcb4cf8d07615247a35a097ef2a936a4d9958f8d9679e612aca86928c2f917ae852bcac2834166793",
        "aaeac82287d56d21719d64b6e7efb2ee9eca107b4f5c8a87a29121003df6982040e26ba20c6666fceaef854fe04f9fd9",
        "141b1223db8ea636756efe1baba78661e57666c87a68d4104c47045d9af009b506aa07f861a792111d39992a7bb3f38a",
        "3d3d738eb74fd6e5d8548a094e6d53b223b4e3e8218b2228275c291a84fcdc7c687162ed18b31a106815cdca468bce08",
        "dd3e4a60d583960e14f914290bd8e4a4a0b3490506fd8b658e03154a891025b981b5a1ed3948a41397076eee92a3ac5c",
        "ba82755a0a83bf8c395577b41b693edfbdaf6c8784fcbee84ba9a160c2ef17db6c9ecc81391f84c74c982a82bb3fd558",
        "669f8e64a27861d76ac5cf8ea78d0702635e36de968876294c4b1ffe150a096ec3a774105a86c7841e649a3e3b35daf9",
        "9186235fc919a4a4652ada9b22714531c390fce86ef61646c97b25435e00a095fcaa04ffae952c4345f4e256f89679e2",
        "7c281aeb4f32d1cf3d19338d2c28a6714c59047a4d3e2b1a0147aa48ca20da7484a86a45c8979b06c2a0baa457236fac",
        "fa67550049edcc170362a52a4fb3b5775458f6c9c46c04ab31bc5404c767a0b9bd10df955d3935d0cf45d8c7d014169d",
        "4b007fe218157d7019addefde61d0983599ed7aa2f06ec18852c16e211f003c5013df0738329b2a04ff25497e5b115d6",
        "a19bf545e81658730c1d2d35ac0afae61fc75d9da72c6c9976e2f82b62647154127732fd578261d28b63b1d209d2adb7",
        "76cb7c6293aaea3f97f1538921f96b8dafd3d6f062384edbbdce358470629b04c36f383d7f5396da6cd500ddf19d2b3d",
        "3bdcedd4f8349c9a0243d25b440d55317cc8d766c7692e8eab7b83a29639d4b8f4707c4736dd33ecc2a763d56d268d6b",
        "a9fa9fbb3a4d5feb4fd8cff86ae8dfa3b13211a2eedbeec77ed7f498edd52882f7e0e9fe719eede5af74d28f0138bfe1",
        "f139b6744fcb0726f73d0aa77d19d9bd0d1258f84714883624034576d978add514f5300bf1df8b2232d05b1fb83324fa",
        "959b5ca0adb70d040eb83e3cb0fbcc8a64df438a763ba69b8c93b27cc585dd02e3aa8779e01c24b85036794a066c5813",
        "173341b1ae859df5f3b3c9bb06effa849916b45f4ecccb79930fec4171d4194daa66364d11b33e062e72c903a917e39c",
        "06416416ac6bcf1e58603e6cb62accfa1538e2195f586becb7e37e240b944500700ce15de000f1e61c041cdf0460b320",
        "ea6babce63c04e2ed1a6313c18d8ed223a66f97bd8345c7cbf36c75dce62a3b1057a6746884515dbf75109b9b1130ef6",
        "da6bc3861a974c4f46f1c8297c8f775abaeb5ad75b9de4ef2c7409712b8ae30946280df71ac2e179c0514810ee2aaa74",
        "50eef4f461ce84fb0ac100f45953f740483bf066943eae17a73578ad8385e3e5230646affc51a7b8800b96afce3c9b0a",
        "e70252b799021c70f2d3949ebc1b1da41feb18650910b1ffe7725083b89ca36fde358aea1e384c9e0da53b2ee9e0ed83",
        "5bef6783fa9f75e6354ff3a66679241981c8d1938f822d713f41a9a147cb364a31935d7ca402fd5265e96968b5d9a6c1",
        "df165017213501627a1bc028a6551cb5c7dbe1fee7ef0fbc219e67ffbe00d19b302ea69e13f8707387e161ce39ed20ac",
        "f194b5516c428ae71f9f7a080ede2838d61daf152efb1a1f5ff34e385884ff3bce83c410c6ddadc677d9950bec864738",
        "da0e7e451cc41c75fb666e288460689ed4f8ddef6a1a7d13a71e0cc6be6ecdff2a8cc1e6c25a5dd36077f5b5651ab7aa",
        "4fff66e09927678528c41c3ccc8aa0dfd75cf4ad0b9da3f9755e5e263569ce9e5dfa770b9c81c365d87c3d68447029fc",
        "6b5ec07fa980039bc0bff0704fae97de45e42240209e141263100461912115235b297824b644330a011a65ae72e0aeee",
        "1d6b8e78e483f63f0f455e7988260d6298493cbb46b78605544d6892a9673d75420ee13cae123f669b2a02810160bbbc",
        "7c054a96f6d3784d4692c435aaf008301549d848475abfa85ecf8227baa002289bfc0fba5ec06534c0934a0b5206a9e5",
        "27e092c180b698dfb078cfceca611a163d0bba188c42b018967aeb88f73c8ee89071eb7c5bfb7bf78c77c4f7983830b7",
        "fa5cf1a6b9c91512b1d91faa8cf043512baf7f2ed1d7b2c780695c335de8932caba56706b754ba9531d4483bfd442fe8",
        "5063050e62f43ade71757d2eb17801ae804a29034364454223e15fde11a194bf85d458ded5068b8786226bd611087f94",
        "297e2ee22b48dece4822635e0dad8df55170afbbecfbb5d6df2b8eab4eef2cd8295d770f85abd7ac712545eeca28d822",
        "35dd931328995a6be6d96e4eea84829d2b74386cb181e7112c8422d8cf6948b755d441eaaaa2daf493bfdea093b35770",
        "367789e3528c0c83304651519395250d8a0663bb8c55e6010814b186d32f7d626d3ba5c3a0fe3e51553b9455b778de9d",
        "8af6fdff9d6605866e1f1c7696e02518a51aa189a77fafb6ae7bad51e7d4e3b9fa56a0027185bded77087d3f375f8c66",
        "92d9a688eab5b27aedfd72d179089087b3a66a5d30b17f734445940c3a9fe1ebd3e92f99c8bea54b4699187427602f2f",
        "0b8eeba6365c91d4ac242f69aa7b97db026a6b37c1f83cf80fb8d62dcff89a73b13a1d70b629be0af609dd75e80d0800",
        "1ac357d81868aa22594bcb6a7686c99d91c77f9801b1f51844f7d118bdf1fbd73c41e353b99ac716b69505cc0e327512",
        "1bf4892ec0b1aa4c4856ffe700c240b26c5ba5a8f64c70afca58d6a7a7581045fe9c22b2af1e3b31f88aeee090484c50",
        "7865e0e15a722b13af363699a76985d651e25f0f4b4cb7072b33f750e701818d0f69e04d40011960418d982f95ff25d6",
        "559b6b430436de8125ab87c85850e464f9eff2fe36ca00792874f2259047b33a382efe9fdddfb4f315e44f002d71297e",
        "86d2330f2bed722294edd1b7907886d1199306d68ab8ea67159880bf3ed858b363e61ce00c81144d7b3571675aa06a70",
        "db6d26f7cbe19a058d225339a41aea885600ae13ae7a5f878627180d5f45d96b26266a5f3447a4b74ce671119ba452f8",
        "f856eaeada2a3d14b2ed13d0cd3814223256a4aa835e0b0e9c2368ce2d57bcd5ac8390f569df4bea0a6e96389e763c43",
        "661625dc4f3f3b833ee463aaa0eab722c79bf5e923f285b177f7761266a063d1308dbe56654503116fa3bb3a9e2533f7",
        "e748d77dadc5dbc283b745ba1b9d365851992038144c33744f5d015ea41a4f6607484295667d78cdc06c9398edf1d152",
        "f762d784985b556506884e22f91fcfc4924d2054f874fdc4f245918efd2783c67c5848967ac1b993941d1a30eb43c177",
        "b2084252fd34016915211391954f4d714f6eb4e06797f507430082a5472ffb6a6ddf1ce7f500b7fe6bf638c43a38231b",
        "881f5f7a21c7309ab201b26b83b10ffda9c883a8333c0175de836fffc1b6530ab3b6c2dd8478f9fa555443954ec36ba8",
        "c3d5e1c0160433635466c40772cada2fa8f3b9dfc89dc6e9e672fb4941c23b6817e53c697ea15fc1d159750a3d2ea0d7",
        "4a5b56e60a8eab74df88696b1149f73398b2a70e00aa6d3397c892852ef8caef87d18d183fe0d35ebca95d61c24863b3",
        "38cb147802e1536e151e5fbdf39df2f49a947c6b9cb271f1280a8058998ba26890513b2a3c6feb859d94b6617bb4d094",
        "7dc8b3a4df269240eabeabf8b3cf3dcf9e4abb02fa094e165c3afa47bfe4c1a1660f71a055f35cc6fb1db2cf514ad613",
        "c3c304c3f855ef72a339a6222734f84dc15d8195d9931a6583537a78adf5ab9336302f372507740a5fe7d78192c5e5ca",
        "933eb256ae4f83efc71b91ce4f2fe6cdbf6bba3beeaa442e3a45fe76dead2f1635cf5837e397deddbf5ea4d1e412ba75",
        "d36e1b99af4fd977f73047d64e206a06f811a95071daf2ef8316722abdb2330c8b2f6a4b30189197822d6eac38be17cf",
        "580d624745dd2c6628b4151ec2f48155655683ac734a2720672d93ff6dfed4f6f74608944a8fd8950da0e70150049d08",
        "108fb597601efb6545ef020b3c2d7081f8cf4fe1c89c81f7c0a60e184b519d98b9a75d574daca245c7c9422e25921186",
        "6e53384c03cdf84363fbee8c4fa5afc9c1a64f88f30c59d2373a668455abffb44152a2725dc16d30087f07b15df722aa",
        "8ecd0208b71d2bafe813370383a7567c3a6d169000bd15aaa5b78d5ca3ac2c9a606692bab9690273c00df8e506446f24",
        "56cbd93b6a0dafb955e5b45899c9a39f6eb9ece4c396411dbd032f8ffc0e906819c90efcad5433796a74e3cbddb3a43f",
        "728c47849dc3a03bff79c94609efa8f5aff39e1dd8fceee44634b1d268bbdb6799e449a920e6a4a6ce1d14e2e276ded1",
        "d6903494d5c786ad99d6f25560708e76780d327650f4e9e64d7d3540cb69b0d564cab9fd6b5f0ddfc7d65f75d4bf0824",
        "b5f0a5ca54902d255f77bc0664d750cfe56ce0740d15bb338774f5b64f9f4f53d957ac3503ef2038df085c551d6141c2",
        "3c934eff22e29105d4fafa6b554be18a7f8a33663b6a6bc4cb8bb2475770fa9d2b27a88bd691b9f91e1801dc42323fea",
        "402744fd02a86755885da3ea6c278568faa12da49537229df975111589c39adfcc9f68088d4307a5509d334c4c01786d",
        "644a13eed2e18738805bbde8f5142cf4b49998c1f31d609c42a8de31f21ac141b82c1d0286acf8acd7e9cdfd4c391299",
        "92113006f00608fb715f594bb342743bf45aa27683d03b5f88ef94b033c86f089936d0244a96eaff36d00a01c3c82646",
        "9a7bd9e55c44e1c2dc3d38eb87b4cca1caa4994fb658f5f65922f582cb2d00033e5f044a34fe303f2996eda34990620d",
        "b71ad153cb91c2a0bdb928378e4d669fa14268ebe027bae9cff788cb124fe26f9462f2766a4ffaaab28297c2f6d222f4",
        "1fd1d6799c0b7fa9fab776793171724064f3e739d66bf08539b18039511c1b21afb919a17c86cd896a30baf905a81b58",
        "e5d4d7a843a25e6f7f1eb9e03d937dfcb8ab43f504782e75efad0e59eb1d400d988435da92191d88c9b38b8b392ea770",
        "feb91dc155e10928bd06bc9c001ab7a192c42185bf17de5cfaae6ec4a8cc9b3a0c899da59525c9ae3f2ec9974dec63b6",
        "eb1c1fd995f54f89037a2cde5ba46369505123d08aa999c3cd6804ae52bf55f40cab93ea0b19e9ef422ac36ae0b9c740",
        "be716675af7622e3ac9dca64b58d8325d998c996d06f9625d2699fba5b90ff3ce05cf29f7ca47ad3eb443809e26ef068",
        "c25fbd468cf1804322efca2c2c6758d48c8624f33df3a169b7aef13b4723c8a6f148691f03c4026a61b72ff9266a3183",
        "42f906466d4a6c3c5f9d57fcab9a5f41a76fab51d2962dc7a4d882810590aad7fa21ff05182a7f67bf671a56c250f847",
        "27c41bfbe0b46e10ace87341a4bfc769dbf1bfe5ec00d3153a98fcab693d10ac6532e31e8bfaacc3102b89c351d57325",
        "f0a82c4d7ac342b535f97739939b9d06e1968ea092109c5b36145bebfeb0db6716ab4e48d2f145b7c9c447f31349f94c",
        "1008b61681685cceb46786e4cac0626cfeb02eca3ae8bd202c42cce1957304e8b8fdf3b76ff77f5a80090ab4d49117d9",
        "92eef7099e0d56912cf4e8585299bc674aafa294f97bb992e8be1d3de090e2ffb668316aa61a577b1bccc652ae70d486",
        "f6e2a3571280ca97c2d5ad0b21d14537a0403785cb51a9234031c91340b1493183e630952b2233ce076fdaa72127e36f",
        "e89f689515bc2913d32e36e40133676c79aef64e6a2c327ba9428a2c2086a6ab02694d6e2818670c3a83fa0d73a6c6de",
        "c6b228ed431b202987b378c79193383f5f4bfed6a2015d0bf8bbfbfa620d6adb2aead0351bb4b683fdedc78efd2f5211",
        "a5629ff2c889cc5912a52d9d16cf902b443d568fa20c2c2964fe3fb6aa06ce433c27d74d51c343d2f45dff8ecac5b777",
        "7e7cdf96f23468598e37119bfc711f812ee57ee2ad64880fca7191f4fa7929f3bd9bb665861b91362573a14757c821c5",
        "9c7a57e02b7ab1b17893cb26869002a9eafcb305260c02e64cac317bddb70d664592eae80eece93eb5f98ab1510d3954",
        "5854fe6decfc66d28f7d9126b0649ab5f800f7618d9c66080ec98d519a656751613b2a3cd37f53e5595287bc14b92e15",
        "40abd6d21007b78291276e0afa39803b7db44f25f12484da41315a7bc7aff32a83c98d4a38dd05f585f5d6f72d97c40d",
        "6ceff4317649e3904fdba4f1deb596dfa9e03c854c5970dbca238bee57d9a926dcb789558e7e446d0f27945ed3c4bb69",
        "5a6fee90d8fdffbd7a24380bb14f276dd9041623d3e4a0ca65a5e15110e0be694030d03b00f27eeb339f2c55b279397a",
        "1556cdc3999d7a5a358b02d80f5eb5cc38b7db57df92f3b09314b5849370d6968fe99171ea1a46cb61ac09cc9d71f7f3",
        "987e06809a34f1b484a4dd902b45e4c1491b37b63166375e008c41d1f2056c81850b50f4a2687c554686faba06c2bac3",
        "cd1054d6961e5052e22bdb8ada229b0d438ef379773093698ddb70f6fa8bf658ae84a17c40b27b310426bb265cbbde37",
        "6eb5e2c437f9c48e894d6ec582539349e6e54c79190185a104c42e999da39c5931da00e06994dad6fa24a1e00b0395fc",
        "36e187c187f2cc4e4bd7587c148bf72e70033b5acdeb9277b2b9f1ce76a88ad75daa10675a690c91550424b668310400",
        "c292bfa8951c2561532e4cc58a7ff42184c969b61e8d994ba8232125e591aec703345a516d723edcc15d51ac06ad4cf0",
        "2c11c0d26439df69cb36bd3a9fafca00dc21129c474adfaeb673af45c0e9234358a1150cce7338989cb44b9c8dec949a"
    };

    const std::string m_7000 =
        "34f2b38f53952b28a0c1bc5393ed5716080793f4594261e0639b0a26e3f824a3dea340466ca32e4c955ffd893f84ecb0";
};

TEST_F(Sha3_384Tests, Simple) {
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_empty_digest);
}

TEST_F(Sha3_384Tests, ResetWorks) {
    EXPECT_NO_THROW(m_hfun.update("Hello", 5));
    EXPECT_NO_THROW(m_hfun.reset());
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_empty_digest);
}

TEST_F(Sha3_384Tests, BasicInput) {
    EXPECT_NO_THROW(m_hfun.update("The quick brown fox jumps over the lazy dog", 43));
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_fox_digest);
}

TEST_F(Sha3_384Tests, ChoppedInput) {
    EXPECT_NO_THROW(m_hfun.update("The quick brown fox ", 20));
    EXPECT_NO_THROW(m_hfun.update("jumps o", 7));
    EXPECT_NO_THROW(m_hfun.update("ver the la", 10));
    EXPECT_NO_THROW(m_hfun.update("zy dog", 6));
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_fox_digest);
}

TEST_F(Sha3_384Tests, Extensive) {
    int i, j;
    for (i = 0; i < m_cmp.size(); i++) {
        EXPECT_NO_THROW(m_hfun.reset());
        for (j = 0; j < i; j++)
            EXPECT_NO_THROW(m_hfun.update("A", 1));
        EXPECT_NO_THROW(m_hfun.finalize());
        EXPECT_EQ(m_hfun.hexdigest(), m_cmp.at(i));
    }
}

TEST_F(Sha3_384Tests, SevenThousandAs) {
    int i;
    for (i = 0; i < 1000; i++)
        EXPECT_NO_THROW(m_hfun.update("AAAAAAA", 7));
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_7000);
}

TEST_F(Sha3_384Tests, UpdateAfterFinal) {
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_THROW(m_hfun.update("Hello", 5), std::invalid_argument);
}

TEST_F(Sha3_384Tests, DigestBeforeFinal) {
    EXPECT_THROW(m_hfun.hexdigest(), std::invalid_argument);
    EXPECT_NO_THROW(m_hfun.reset());

    EXPECT_NO_THROW(m_hfun.update("Hello", 5));
    EXPECT_THROW(m_hfun.hexdigest(), std::invalid_argument);
}
