#include <gtest/gtest.h>

#include <toycrypto/hash/blake.h>

class Blake512Tests : public ::testing::Test {
protected:
    void SetUp() override {
        m_hfun.reset();
    }

    BLAKE512 m_hfun{};

    const std::string m_empty_digest =
        "a8cfbbd73726062df0c6864dda65defe58ef0cc52a5625090fa17601e1eecd1b628e94f396ae402a00acc9eab77b4d4c2e852aaaa25a636d80af3fc7913ef5b8";

    const std::string m_fox_digest =
        "1f7e26f63b6ad25a0896fd978fd050a1766391d2fd0471a77afb975e5034b7ad2d9ccf8dfb47abbbe656e1b82fbc634ba42ce186e8dc5e1ce09a885d41f43451";

    const std::array<std::string, 134> m_cmp = {
        "a8cfbbd73726062df0c6864dda65defe58ef0cc52a5625090fa17601e1eecd1b628e94f396ae402a00acc9eab77b4d4c2e852aaaa25a636d80af3fc7913ef5b8",
        "3402e8714e4cfd44366c8dd9313ede21b41b782d0971a6eec2eeaf0cd872db85024e8ab78c46e811618c0944594fcc9ec98d9baf48e12d28fb279449e7262b0d",
        "13df0c29b444980f3a94c7d2ebd4cc95d3480ce6f89946e4c49531ca120e1f3f2929e8ea07da902fa093e00a32ec3c29693f779f94c0526d6740d97466e44dc9",
        "bc171f290c50069b9769a847d3954924cc6a8c52dc6718bab5ad30acf9085d294db66394eefcae12cb738602499aff473624cd086ca70f8fac7f3ec4c149c2cd",
        "3c4ce424bb86c770d5ecde021dcffcc17a18a6ee10bef69ac4e33d7f342ce867d2f59873e3ac804f8610039b2d8ad3cdaaf1b3fc802e1de4bfbd2f3ae080f250",
        "1dd1cfa7d5f203e5aa483c4888e0a14d2a5e8d508f8713aa4c0754bf7186b5fbcd4b302d0f6480073b12b5eddb92333dbb66920c087272bb02afc11e7b8a4a17",
        "355c1f97e833329a3542dbe06681907c8ac2e897dae0a507414ebe2084a15d9147100014781c339bd3e7d0f1c20d4865b94b98b5e5356cf3e7f877af5654fbf5",
        "b774a7363c63d2347be328d731a958386bbd402943e39333629f549357a761ea854908fbbf1be313ac70c4056fa37a3cefeaad9140ac0dd35552eba5892c6313",
        "f84bb90fb3300fd0511a2a98b74e45f7134adfd957daf202c09ecd83448db42b711e1906ba62c3a5a554444e0a0a56fbe54706ee042f59e8aeaaea240b8f577d",
        "d706420b55ac34582474b523330d2d2d9f28a5bd5e025b2dc837ae4afbbd5cbd90103e35024cb260f8863a0491f2ded192c68cf37bc159c7ae915cd8fd6710ff",
        "287d9d2a320812683151c12c205b6f4ebb2e48452e5d8ac1426a71abb6348de0e8f4ccd376c2cdbf9c96a9a6aa55b88cf043d6e180ab68e35e7be1ffbfae4be0",
        "cc01fcfe00e169c3352ae8a6c1f491d959283ac3127af3c07f02adce4d6ddb7194defead3ddf7ddd416db5a9fcaf632c7095e78eaf7ffaf0247bdc44c49ec8bb",
        "1fee7a54b21d0dca21cda2cfc55604ccbdcbb32b59a2e17164438f453d477e1d0ff3912299fc85da58bdcb52662c5d01e4848162031fde4ff75020fc5172a121",
        "c02c9ef89b0cff8b683a0a3d1018c90cd56ed924d2c8e71151f2086a6e2e67b7ffb524236983aa8a8ed1b8296df6e6de5d14d2aa772b9053d0068bec4961e3c4",
        "d5afb85356cdc15e71e68873c3626f7ad8da33387a72d6a978f9251ea146159c3567388d3953b7510c76fa20abdab4e13600973d43d7e82ca1487a83417f5f50",
        "a4d420d05157cd8b1fcf9140c75da5034a43b247828fe099bada70892686004c332755d26f19a1266fcf654eee90326e0e8637b7fcc6986fa5237a4702cbf029",
        "09075e823add971cb183b9d8bc8546e2b3600396a88d81284b6f7975875a2e6be1339e6e123c6101800030ea7990bdf5c3e549b8087912c026f67666e2cc9f67",
        "2583e0c6b75016067b6570705a094046ece326d2f4a77c787376a29364e28e274d352e81f49c9a1d6b4d09f6c0543d05c8172bddf261324c28569b9a06757133",
        "9f1cfeb76dfedfff3f25902bf37197c0bf3c7444fe25f82db63a424819c574229a2402bf6bf8cfefc4652f38abbe58d2e1b105b02fb591b735dfe47ed866ab5a",
        "835bedebc82e2d8265b52948b16fbd0edd3b5a91261656752d9cc4642a218f3757519697371f47bf82fca0a430433cbf6952222863cdc9dae68002aa145c7c26",
        "feb32efb50877a949e781905784385cc8b8fe092c6a86dc3d1cbb8563643428d7fb637ec0c237ae557c16146cacf203a6b96e0d86edabeb4d2695c2d9f6a35a3",
        "9d1b674e130f6d30d209c726262b5dcc2d1ab2e60054ef5aa1ab717b7971dfcabc59e7365d3dc967deb11722d90600646852720a3de4e2e31b0c3a91cb6eae16",
        "155dcfad36f0453cd970a5b831fb43adc5f4daef4949a17a0563591fcfe1cc0292e6bc446110dc23f3c1ad5a233df328a3943581ef766db444086da6956f45e9",
        "f5cf4b345d55a8943b69eee2777e891de46e11375fdd8b8fe15d5a26c1a2202f51ed4ef8d4fd3e8515c75fc93814d09b5d7e54d80d25856cb776a7f66500bc10",
        "97ac1b0b3fbd4a1ac44d8bef90d3205d42d926627bb1c43a82f59f83b041aabc7b901a3e379d70d045fa073bf94a558762f7e80e84f29506aa1dd2cc7022f9b9",
        "93f6a4b7d9ae28f15e326c91fccbd053908377a0e0c944272dfa1dbfa9669ef9c8830412e3760cfe6bd35f706574ff7f46ce9a7e650f45835ebebd74170d8130",
        "c4aecf71112ae5c26844bdb0d0e927ebeec0b7a141db3662650e3f61cc847b715c0740b5dc0803380e5062c5b8914ea7fb5011f924d2b411d20207451dec2776",
        "4c11aff75763d1c2b411187c8ef0a206a05bdfae0fa3f5e708144097031c2e7e303ea185d94eeb845a8d055d23aec5a8886e40506deaa3d229aada2833d5427d",
        "c68197335b8882b22fc1afe7ee1b889dcad4871caf41f967a2ec859887115b915ef780d857210eaee9d2c92a3a6d59caa92d3ccdc0d7bf6547ce706b2b03d545",
        "2ef2afe0b2abe4b1e6cf9f95084b23d88f0b90a1d5231e20d09d6c1700a4e6a92c8fed46ec638a4b89a49142d182cd4a801c7b1c19a4420bb83a3ecbc251ff8c",
        "1911f006d297d77122a52fd94573a0c191cdc8753adddb7372ff689a0c163f3efbd1c0513b00c2ce8a1ce2ff58da926a4a9ae704a123729f8b21e4e3f6ba57ad",
        "82aaaef274100721011e39a54254cf8b9b6552f104132d3364e1737d969acf7306235bbe81e9e03c7d37eb606ae5eef87d11c31c23a8ddb34115ff3a595632ae",
        "5697dbf240060b2fed0db21a629a16f22ec5f9084d97e18e409d2deb61d203dfcd8f277a7718dd8a68602259d731166519c822f4a3e82eacf5e979b6938b43d9",
        "4cbded10ff044e489d6eb8b68324bcb7681691bdb1dea919b6726d72bc2b24ba64550ac5f4bc7f9a00605fdc742deb6f4395214524366dfaaf03f018a78fc7e9",
        "33485cd8349086acd988120183167eb71865169f23d689ebbc41eac05500908286a08bd0099c351a9058d83ef549d3f2600a5a7d8a9c5a5c558127d20b29ba34",
        "6caa26c56488ff55d532add184ed83f53920d1f8f6111a9295986b695fc5f8e560ac2ff284d64ac2fad995af0139ae97b2aa5cec8d385412eff579107214a178",
        "3b678ebef370856297b5bf95653526131bd9e448688f9524858dcbcec705292a2a3b2f59eaebb11dfa9a6252da7ff1022e39611396a6c5fb7856bc83b8d738ad",
        "033b0937cdde83e5c8829870ef747dd4a4842c0beab5bf4efa92aa87b6a211a35c836ca6522ed4a744e6bf724dadb4b92bc7bd6f32cc7058050053607539b977",
        "6fbfa30d967aab4080b7c666c50c965e927d83e5705da051ba8633bf9c4a98f94940bf4a2dbe3810d815b0c0fe583ff65d73707b5787d1438d7a8832d8f09b50",
        "4b8a9de144151f3e1d16e6a672d1c916bbd9a31a4299d20a67ac1fa6375abcac7e5a39912d0320c9c6c8419e8da85d56703840770a6e92d5de0f59d38497b87d",
        "f98a8301c8ab3f86ea4ba47a62f505f3d56ad12efa531b74a7e16f585fe96deeb8c3de43ac5c0abf72c6d8f1464d37a2c6d41b735003a41c7766d6ee006f07c9",
        "f2bcc4eb3b92f2f217585b6795fa94d0937046e948ce4fc70c520f7e914eda251845f8237d99fcddb42c47ed043ab0234c2a0c018ef537518ff838dc17a67a22",
        "98c0728d0ac07cf5cccfa4f0d21eec8fd7f721c6e6a44dc6d4c87b5820779a04ba7709ee4bd908eba0b9c1e72a75f4cbfdffcf0b1428ec03b6fc1754389f7bc9",
        "40120932c4513930d5e32653e2da296a060a63f18b778021fd10a012665c1040f9d115bfb2e9fd7cbc4ae52b067065f2a2dd887f68409fc36215f44f0bf5bc8f",
        "9570efd78f5303b975ebba1cb00c6476f7cb697a98a624debaaa01b41ef56d783f57e23108bef0ca5339fc1b526ae5424f8eaa247ac31005398acfe87ee74f96",
        "0d53980833b7cd023f19e0d037e32c512836f37c1c2a5bcfea7fe17fdebd78fe775f9f49ea5346af77a88986686bbeba51ea878e71537ec4b42bc8fec2eb3a15",
        "7e4f0893ea3e45fef1cfa1938fa5ae7abf184f9fff9e454909e0b79b8c7263ea15e14cb4f9895766135789127ca46f5f9974715f2973547b8a339706ba9752bd",
        "e4289f220a1f415f7afb202cfa2aafe80ec71ceead2f41b57c74e08a4f95b301bda3b21dc0871ac004ee093f7e065938e867190065cc70e50d505d87b300fbed",
        "61094a30b787d473392cb54107820d62583c6bd3abcaf836fd216d1f10db4e6d63bacfb6060a0672bb9916e7e8a7822ef467fab9b0cec80a5350c5109dab19fa",
        "600002a1e2221ed69315b54914dfc6618e7033e0ae8a5040fb9bbd3b20a854ae19d5d5cc532d643e1215f3af4bb644e96e0d499614fd81c49043c4a2243a6e53",
        "6ed57fd0c4994b7a9186b291ec681667025f492fead2ac34599843eed3e42768b52ed8352a46b1874a4a820e187a81c524f6b2fd53090c3f68fb609472b7a32f",
        "5318c10c2e88e3508331e2ec767d0c9135d83f572d40e9b8a549710fd3d425f27ec1c023ea6b3d6a64c799226526facc452483812ea4d8342425104c4890d1b5",
        "79601ad4b09424aae535bf36e3f520d38a6b9eef9ebdb0f3db6819234430e1584122ed4121a8e4fa45d9481acf966053642d762648821a6c8463c38bbafb94e0",
        "5ad3b38ce567c69bc450acb37b9b6d580ab692d6c891ced78aad62fa0c1ee5e3c75ca3c416ff7b2d7f5ac8c100b4b5f5c29bc99c3b8939de618e477264cc1e17",
        "f624ac9060669a525199b27db6b4afe96ade5044b9085ff4dee4daac361b921e84c97ec66077f8afad53c8fdf468d1ba4cd4ad90e4c7bf8e9f46e7da27121a13",
        "0060c6a59bf66480d3e9b6aaaf22594d220ec04f1ddb09ddfabb93df7156c4c332fcf58eb1152367a3f1e9a438722faa1698c88e93ff5c649edc0575e0b23e64",
        "788cc7f7c6b0dbe2e148ef621261dfda5d4bb38245402236827a9dc0026e87a6359165b32869ac2c6226619e241b291ee416b693ea464c9ae3b2bb87a72d468f",
        "1a31bb5ccf5c45209778fab105c039d780896eec9331e5a8fd0dcf3df2edf8f7ddee42b8b48471b431656a8df4a77b8d1b6723029f950078c506ab9a688449ba",
        "26bf6fff00d299ba44914082898aa5dc972e900631ab7d3a1feea502e3f8afe42b934a04a3aed66a2817831ae201fc359b5ac2faf2947e2e2d041a7fad8db8c9",
        "a8c05053fd621bc1bc9978d3a0e96b8507e7d30b7f0ad7351950d20fc91af2d740115bfb45bdd2114efb4628b685ec29752db8e89c9af44aa68058942642ca13",
        "de5bf5cdfe61b22cdfc317a4167378906e437b9a3a4afcdb124b25632e12839309cc0a539d99e296920ed254b7ec48e88402b17fb978a6bfeaebf1923ce08e34",
        "6696e885483f51a841d17bfc600a16aaa295d7b820aec621622d3d4f7dc7e4a7351cab2c24845b3e3b0015bd2cd139017e68ee6fb3c19b56cfb5b631830562dd",
        "b51a8ee5c6c579ce375e87bf427fe69e0509a2361f0c4cdd50f63e1e2c7324fcbd4f131c1e7d97dcafb357c5fc6f10b153baf8f684d7dc6b2e1e7f57edcc8033",
        "aecb7a1e82b89678c711e623e87932e6acc327867afe78a65c5319ce0e6bbde615ae9afcad1001b91e7c3f47dd449d8300050448400885c8446a263c307849ae",
        "06fe55edb589bffe84a629f5bcbcefb49cff04b161e6e9303b74917e5dfda5ad22f28ed5c79aa8dac00d8da481c957c6ed654d3f30bacb12ec53b51d1b4ebed8",
        "5425e0536df13230804970ab1ede23dc96f061d387bd2b054869a86a962ada8a2957821c53b012968efc82104ba420e87c572fb8058f18e24f56373af7a18e4c",
        "7e9db83f2a7e48ae645c85f2c8137fd2d95295f33b40a3d4429e43caa03402b88c930b32034b0e2ff5a7c52d6497eed2f8fc6c251a3388ecb72dcf7c99c2d9cc",
        "4e8c051d06e9ee2550d9e3493c10e3c31b6440447680a47492930fd6a7fba4a762881a164ab0d6c4e45253d4e79972ca3d3b680dc4abab4e5359c1ea6eb83a4a",
        "9f79092c25da8f3cdf49da43abb77aa2cd4ab1df42cf3202aade955d590481fd6f221d8ea988b17507bc1452a2eca974923caf25f6f7d3556c949783ee9cb725",
        "325d5b96724f479c3ee4dfbfd4d81c2652b292d4edb9edf26604106f7e7a3c5670fa031ba05f1ed3f275dfedf4cac8e33921711b063acb7c400197fe224ddc21",
        "afa402d3e4e64868e084b284fa2c9a6e473aee3830a5188a5906d6aeff3d2658db857dfc0ba761c65c90d7c731894ebfbc7eb937bfe243be86c0338986a8acde",
        "684eb00d71c81018261698e249d967261642ff97b1f175fe532ad1eb99fd310b719eb3edb2d695d41a821628ba1c6d16663a1d1dee39a3b194b7ecaa8182e811",
        "e1e809f1e9258f1ac252b268629ae8fad668c955662e69a8e91e7275694450fb22493b11f9eaec3fcf12576738632baf5dad8b617b37528cb069b0eb2b54f7ce",
        "56854f174455016ed4502bba79d95d067b9f08cc86a52fa018674d7f916a29db0e88f5ec234548922ba7e03fb65d7cf76f1e4e888a51960bf78a8098250dd7d8",
        "830b139297fda3bfb84365ec06df19a1bc9a291706f7f268654f44c189540662f7e4f2e65704f2b8f538dd6f19a3f3318f62977c189328302ad226e62b066cf7",
        "4514b6fc55dc8d16754f6d8a85f75d4c1f7716cc26be7a5d98ee578fae722dd8bfeff992779cc43b871641752cfbadb27be5cf8ea9790c97733222f414244fe8",
        "f085327ba6848603ae5f7e226a9c8f52b0ec52760c1c78c39345ec951979b75d4c6140672ce9a0ed402eca52306416432042cbbdc79eabb4987c3e852ffa87b6",
        "ab5ac7ca45c13b92df97838e66207660dcc38a3cb8a4ad20fc4c41717f7fd1cc216c762dc250bc364e342da514124b6d107c2abb7abc269d26f8249c31d7da9a",
        "4f9d469395d229fe5b3a65e93244d8044f0841593e4de084a6f4d445edcd3ede483946e7a37fd01bcf64200c83766b638966d0a640a795ed54dec10cfcbb36a0",
        "50f4af82afae4da2f776a578e28135d1e5c91671de4d2be3bafffa6324e44ab36ad0413d2a847ab63d46ad01631e908b8f1aa848c9f07ebc16eec76fb9bcf9bf",
        "44cf235e8f055c3efb2f635b574b744d1925f271ec15440b97582ccca7bdc854b5071db6240e005503c1c3887fc14246739aedf19d195115f9cd571162c660f4",
        "3f3a3ad1d29307981b580aa2591a0e48fa370a26afad48137799b0eb54896aed3d302c827928d8976a6e226358a419077a74fb627e0a9343897bffd57502c6f3",
        "e37577042619ae5c57680843dfba48eed9475b94e6c58cca210d8ea9fa79f85fc55c4ab59b1a5441eca920179f4a555aa7286e0999fb3d8b90a9bbaf3abe81bf",
        "5201243a730b4818b6b2e205773203581540979f57a517222f7a83567201c5ec0ad6ba469265090abb686d40aa74369c7df597e472544d12f0c4092ae470019f",
        "55e6fdb621c1b968cccdab32f6654b5fc8ee8353e92272d7c8c376deb74f59d7e42a43e02132d1ec57f3b80549f52c70caaa53923c662799caeee5627938d1dd",
        "f9d68787a4aa5b4e9b003f6746383836047d77520d60ca81cb4e9d04bb6f7ffc264696e09791dd0232dfce8e506d80e5cb82ff44e0948a82c30f6d12147bab95",
        "94084ea727e8460b76a1b29b66708f7d4dc01bbb6a48340298ee78b928182186705a1eca54c93132b37f94310017762ace3f95aed08fc3de1b85cf377fb12e02",
        "439c28fa2724b65b1116609571aa61e735bfe0fe71936aaa78d2a203e0e1dbedabe0ca7a101283f5c695dd457587627bee4af69090067566d494eb04ce451eea",
        "1bd3e7bf076096ea45ca4e83b1f6c5139238d3843fe670f5d56a440fc8799ee9e5de955e7460cfdeef14e515684e87226ccdf4f441eaa44fe57329421839ab9b",
        "73ef2be4dccb10513b74040f3984dc502bda55a0488ba9a3778697453e36666074e00d66f950de8acc33119cf800f6a9771d2c5b3d91be42c23cbadcd38a0148",
        "1349eb6571d36e6fd0d61e710e1049a27e19ec5ca583793bc22e7a8eabe2762176a74eb17a40c9c79d641387ddb0de8048551d9c61f74b0520ec10150da2eee3",
        "c5e0e377d030c3e6c3bcc840546dff16f3c7222af84c5231d73752a10fce2c397ed11ea6eabdc54235008f34c691c02aa3ba16b16f02da4e4838e4df6970f788",
        "3ad4827785dd9da2455494244cea7a961d3b1a4558ec68bdcae3403cae2ed1091830c9420134424ed0adb428b39a33a7b1d8dfdfd65b623fe944b295642032aa",
        "cb7891c8df6f86f3a0b8a325ead19dd7f51b45734157772149b2cdbe198848780213d6e60836bfa011ddf2df1d2fa7563ca612c4ee6104678e1bbc1fbb898640",
        "95b805bc82b6e73e9b08784ef2709d2e87536dcfb730be9c4ce56b14f0e9ddb2ff150c96ee7bfde82e21712dc7a532b502395c2f12a2fe18ea1cc0f9e364720b",
        "7c2e7a9ef1f57053910872f492fa4af732ef168bfddf79b23ce20006687f6b13199dd489278dc87aff222d243ecce0b4000729b9e66d2593f917a6b2313695af",
        "076104b873ae643bffbc5e394ae1a8d5e958acad6ea865a1fdacc658c850f4392f8f2f4f5222801165b891d3e1066b700638578ca340497f39719344c9861db8",
        "b584d0816fecd3104f5775a224d7d3fd35e7b83da7b4b373cd44d89c48259182a8c0e6200caac792d3417dd084349a67fd7b1229783fb2950ee39b040f9b639f",
        "74620f0a4501299427a4f867a49351126c769a2255ae439a42bf23910f1832f5848442309a5d6fb7f40d6363e41a21b5e957d4cc6af534e015458995dffab7f9",
        "9df259022ff9e08b0853ccc31a4f46e7726698233b8f98e5661bae573d86dfea50776a0bbd6674d1098f85cfe10bfcc6379c985018e17caf45c024cad5a7c065",
        "efd8a17fa93be3d22129806d8dcabcb819e62c37582ad8beea9d2804bdc95679d79999832b43e2cbb9aa8c72e0b060044e4d0fc4fb6ba8887b26bee92c4c893e",
        "45faa63ba84edee5cc34d90b85658f627b5f3bbd1bad205952790435c9266fbcc2c0413b1ff62e0a8ce5ffae0a7f87ba59ecfe434c3397419f4fa2d7d5610895",
        "22741c014cd69688b297f512d4adcdb55f5b0b0d91f0071d652e7667b7e796a9c9a494c0b9f565030648d5a76cedd1a158c6c8844ceed206645c0a75a4409b69",
        "1d92d7cbbc8dfaa771da6a78a4367312033a008cd69de51e6d9e280dd5b5b935c2baa03dd741e125f8f2ebef6701027d751f0b8a2a21d6109175f6a594883090",
        "c7d2c7d6bd568a3f37466aec37c382169ebe54ffd4527626a9307c85bb99fcfbb6e2ab2d0f218995628f3130190c960878d2324ff34694aa38a79d9001f769e9",
        "f94592c687f67d026d506021cc4b13e375953d34265b8f5f07987dbdb2e268735eaaa1b9ee5c2a2b231b36399e6c801b5abd64b37fdd31d1e187b8df5d26dcf1",
        "1f21be8823266d76134b6885319fdc4be444f0db2d45b81dcf85dea33064613e553fbe1df1adcdaabd8fc3fb172df06ab5ce242c78c28014fd8aba5626fa5747",
        "d96b6e31cb8f01148b904b2540c64dcb9748d4dea3553c0605c7166ae30cdc772d78b328ef68a45bb7cc628c4a0451cdbe23e8470fc9a31a79e138dc5e4849ac",
        "dd0c7184b2ab6be31af2855160cb6824c6aa8c9dfb295ae99cd009cb2060700a2117fe36360d2219e5061683e63569fd46ee4887b831cf4069ea9b718adfe99e",
        "1d13505200f3eb5a0ea3a4de2b9f9329275112bb605428507a3090ae503bdab93426f835a0661f5750ddc3bdcbac6d9449e1804090628b5b4e4adf3c4719c085",
        "9c1f2fd1348708fe5623bd5ab4fb795b1823d69cc9abd14feb31ce3ddbf1223f9850c0a1f31b38dd8d7d9483a59d0a41f395d44c0a5698cac9565933c27b5961",
        "20d0cb7b106bd97b00e0302afb4fdfede5863a23c5fa9f27290176219f9d787d11fc9d20b3db8384a78ff1805157148154f4024b9848f5addee9cf3cecb75460",
        "a07cc0c8179ed6707cbc12c1a4df02b6646f6495c8edbe81b57bd104adc60041768092d3200acef1bd0f02cf86a3f6376e0f41144892a2102db25379db084cf3",
        "8402dd873687f5d666fc775b6b287570a6599dd8dd4dd6d1b1d09b48ae439137f62b826ab391818ec460d40b60d491994a6f0bf8c859f648315138e95080d855",
        "70466ffb7cd83dddfd8baddc3273a9405eccd383de297646a641d87757867f089640e179d0e6e366c539e6d3a5df663a6f739068871859dc5418247f4fd8261c",
        "7ff9077e9b782d585293098f9b8a0448456baa375fa401a91e4290079cf4e706c7a8c4d14bf7ca01e78f33f4725b95f8e1a10444cb8259e5554d90319ef576f7",
        "4981ccf3fa895c976d39c73e200065fd5c3309525c41004a055f7ea280f52d1129677b951c60863bcc40d09ebff4301dc7bacfc41fbda4783bdd25cac98bdb82",
        "25df847c6d477888789a048d57418053459ab8ef3c44dceb20d0662838d79baf5a0f4fef16e8633f39567555c4eea7f4f2a18c6490970486c75f84c78e676aa4",
        "fbe4e480bde0a683e2c7a6233ce60322d40648f5b82921c60bceaa3eab8b3963611659ee6b450adb763709c76d6cbc0a2cd624e8dd54228ae81d5333306326cc",
        "31188c0a8ec22242a10aa974b699fa17a4778b50b29b1c338d394fb3a9da9f705ea9ed96658f0d0ff07496b7013744d43b0f359d3c72080699e5ef3fe0dbed52",
        "6e39159d150d6e4b2dab96512a8a172cc609619ee3228dcbf594f8f7c8bd67784398b956080fea147f6ca199e552ff6496a1c4c5202f2ba8de9f4e6595c1d93a",
        "5f2a87809db5356ddebf081f4b3625bb48f87d69b820295a4868489afec4168d1c1345343260bd2edaceab5983d851f1173bb029a604d851e5e6d821fba8b31d",
        "101e53afb6adf63db6008275d2c0ddd1e0815f365826cf263c0edb93b5dfb3db6dd209d6ec85e98c963a1e22eef5040e975b41b2230834aeef6ff6d854df3111",
        "0659d0b76e5dad78ebdca7a68947207e29d680d1b5b661217646c34e274ef0c41bf4ba3e3e0c7491c34a4406d7d8d5deb335fd714ee0e590114bc2902fea1988",
        "38b2574e2b66b5a85605810fa72cb0afe89c24805a2b6df5d990573ec249b498ea5ef5dcdadb674c828338d0725eddb299222b458e07083f63493190f1b6cbb4",
        "52c9bd40941ee8d26d592f156a0b6ded87ae59a4fb444dc8caa3fd5e978ea2cb6aadd85192543ef9ec8cd9d39d0c0f98b380590fe966d0613fee08a336b02b2c",
        "79b9d69b7f8b13332357313a59ce7317ed9875cbb2e7cc71d93d88a05a861fb9759f92997b21678bd5b9b399720916104564e32d8968a890de6e9e98c1dcd26d",
        "0e1900b002895f85bfb0c5d216684cfe117e2dd787254ca6a44cd633c3c735ad7b707480b5db076582851bb8781c6fd7459e3e0d86bb8d6be8d0fe6b6ecfe4e0",
        "ab691f6ae2543e81bf3276c7ea463212cdeff7b00fdc804e6f07965e1e1343640f60d0e7174438c6d67eb76b900ceb6b1fed7d9bcf51356cb55e59891ed8fc6a",
        "228c1a8d41585c4dfc3a16659177f28cfbf1b2b6e114be516aeb27bff44fc5bd7142ca358039578f4e23b8e7c4fb51f71e8a7a5033f2a0d677d74b83499751f7",
        "7c7f0a1c0b6f9d98aaaa0b26299440d8cb3bce3cc6a19e9d14685c9c83ea2e034ec8a43c2320696fc0070f77d8258c4af0e018a840c1cae6f4ab676f0e08685c",
        "85eedff50289bf6cb0eb639b3ee599937f2641e3e0d4af48d4d2b443864b3bb4f731b785b1c14c921c990add868f74eaa9f43639c06c894b1904d98373611497",
        "2bc152c6c41d607bfc962cf6f57e0a73e33dbb8326317b7637af0ab046189a6f9fc69b9bf23f2eb679b1f02752e2c21aed463ffbabbc1b099089b65ab727ae8d",
        "d46248384d957fb5e8cb413ae718bec20e852d8895d34eacc9ed2882591f30d2a5ce58c76dd0a557ff49daf7b0ead03739354f180e74860a5f5926b4891495a0"
    };

    const std::string m_7000 =
        "53e22337e78d146649d6be1e0723d552f5e5d4aefbcd401825dad5b10eee49bcba3127f0d4997c6e396c6dfad0827070294945459edec90c2bd92c2362092089";
};

TEST_F(Blake512Tests, Simple) {
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_empty_digest);
}

TEST_F(Blake512Tests, ResetWorks) {
    EXPECT_NO_THROW(m_hfun.update("Hello", 5));
    EXPECT_NO_THROW(m_hfun.reset());
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_empty_digest);
}

TEST_F(Blake512Tests, BasicInput) {
    EXPECT_NO_THROW(m_hfun.update("The quick brown fox jumps over the lazy dog", 43));
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_fox_digest);
}

TEST_F(Blake512Tests, ChoppedInput) {
    EXPECT_NO_THROW(m_hfun.update("The quick brown fox ", 20));
    EXPECT_NO_THROW(m_hfun.update("jumps o", 7));
    EXPECT_NO_THROW(m_hfun.update("ver the la", 10));
    EXPECT_NO_THROW(m_hfun.update("zy dog", 6));
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_fox_digest);
}

TEST_F(Blake512Tests, Extensive) {
    int i, j;
    for (i = 0; i < m_cmp.size(); i++) {
        EXPECT_NO_THROW(m_hfun.reset());
        for (j = 0; j < i; j++)
            EXPECT_NO_THROW(m_hfun.update("A", 1));
        EXPECT_NO_THROW(m_hfun.finalize());
        EXPECT_EQ(m_hfun.hexdigest(), m_cmp.at(i));
    }
}

TEST_F(Blake512Tests, SevenThousandAs) {
    int i;
    for (i = 0; i < 1000; i++)
        EXPECT_NO_THROW(m_hfun.update("AAAAAAA", 7));
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_7000);
}

TEST_F(Blake512Tests, UpdateAfterFinal) {
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_THROW(m_hfun.update("Hello", 5), std::invalid_argument);
}

TEST_F(Blake512Tests, DigestBeforeFinal) {
    EXPECT_THROW(m_hfun.hexdigest(), std::invalid_argument);
    EXPECT_NO_THROW(m_hfun.reset());

    EXPECT_NO_THROW(m_hfun.update("Hello", 5));
    EXPECT_THROW(m_hfun.hexdigest(), std::invalid_argument);
}
