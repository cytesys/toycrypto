#include <gtest/gtest.h>

#include <toycrypto/hash/sha2.h>

class Sha384Tests : public ::testing::Test {
protected:
    void SetUp() override {
        m_hfun.reset();
    }

    SHA384 m_hfun{};

    const std::string m_empty_digest =
        "38b060a751ac96384cd9327eb1b1e36a21fdb71114be07434c0cc7bf63f6e1da274edebfe76f65fbd51ad2f14898b95b";

    const std::string m_fox_digest =
        "ca737f1014a48f4c0b6dd43cb177b0afd9e5169367544c494011e3317dbf9a509cb1e5dc1e85a941bbee3d7f2afbc9b1";

    const std::array<std::string, 134> m_cmp = {
        "38b060a751ac96384cd9327eb1b1e36a21fdb71114be07434c0cc7bf63f6e1da274edebfe76f65fbd51ad2f14898b95b",
        "ad14aaf25020bef2fd4e3eb5ec0c50272cdfd66074b0ed037c9a11254321aac0729985374beeaa5b80a504d048be1864",
        "29d1020e659f20fa910f7d9bd700630ee02cae41686c2c95fbf00bfe579cfee99673322cb96dc2bc584887ebad9ea1b8",
        "8a5b7c19bcd1704d521f86b9618d86de0ed48fa29711ad4d16230f7d26b36111beaf7fefe8b3be7a17ce0e140ca002fe",
        "d8bf1572ab3b9bc239325d2a657ad37cb8fa6cb32c2d83cddee33be1238eb7a40b33d1bc796b426b6c68c22e4769dea2",
        "b954cd07aaebfcee158c4a855afe4711b71a50836a506aca08aacd8e16cc43c78aaa544d08d19fcecb8034b90c91ad63",
        "bd8a57ff9832c1f8d41fd376b63482878e41fce732b516dcefb539f8cfaf77fb9c4276576243580a6d98bd0cd97f7242",
        "14e5fdf2aa72ab4df71f5297877ca90746f5acfce3174de7592b9ec9ed361b415259f71020fdb1af516ab5cb92414c05",
        "6244bc0cda92994edacca0d44e3debf80111f851ea1be2fbcb4a03de55076d971b434e009d3451e84884a38351047362",
        "3c49ae4cc056a33baf142d069edd3d083e112814d8fc283e502f3bd994a9cb1ff6c07c4f068d2d2a3fdad0891d1f279c",
        "5b5742a60a19abbe20375d2b06f33d1eda923a3096b63ddc7211b75b55a535a7d888f9f7a34a5869c6f56b647e361ed5",
        "911fc3de02447172c2d5e30d578f2333d607651c6b7defd1d2770a9477e09422eeb0fc09f6d9bf03ea5bc5577bc210f9",
        "bf326cc6070d00902a67665d5435a6c217bded742b03ec51d665245b3ce131bcff92d281a458e6918ff63c7d6095cc0c",
        "1da0dbd506c8bf6e6c83e45ae4a7feabd112f10b6f60e8dbe6acd2a7c3b081107bea10d3cfd80b5bc0fb4a05ee711328",
        "652d118178de6dabfdea8a3938a31dd1580cd5aaed3566a16b154b64203452fc9bbaf1942da327a52cabdffe8610898b",
        "aa026f748fa5f12ea96b5f13339c242bc4896fc7223baba81ed2dad632f1c37699423bee3ea32910ed044c3e3d966bfa",
        "625e9203047c52a1e290189bd15abf170ed886a33190803e04402f4d48b10fe05ab12197f9cac253749a5fde0822c734",
        "6af130642e08124baf46c92061e61d06593c5a638c4668dd6dd74b0d0d0ff9641db2ef5db066b3c231cdc1a55b4ddf59",
        "4c86993c290962e7dfc7653f3ab748ca32906121b2aa408b168275452aaa4c89afb9d78bc3ccb249853182ac52e0bd33",
        "e4ac75d9e79506cf606198994c79ad5959dec47becb7b9d3e18c9f5a6fe4349321e2a6df9566fb2deba49e375fbc0882",
        "8342571302df10c55a0067bfeb42142ed030a0dc745da36cc583bd8f1069adcb5a0e701d320004a6eeb434879132fd7f",
        "4d2791aeb8b30c543cc95074d5e719c2bfdf3a81b2446daf04a27c3316ed42c6e05a354388f1504f40e2a89066519a87",
        "f3f619f64c090fe95d459b50e97649908cc8344a26b04ef64ba959f4aac71ab766a3df0c1e48135a23bf964f5a315f9d",
        "db53157e6140891759d5fdd147a04670f2c45d27e53c82b1f64f7979adac958d7c69e6c8ed3479c0e5162e602da3a10c",
        "7bea008598f2b0c92f71dd18ea6590c5c5d3dfc84cb1e67612b0e38c6a81bb892d2228694e66cc64955008758455dd90",
        "4d7ec565e334a5000b0da81389f6d984ade5756fabefdfb5d288d1803605648248dea7d6bfa954a0e4cd53292fe0461b",
        "d3ada54c9d4e978db617b0a5d8e7a4456e7158b4b7519ca34bef2c2cd2c91a703be842e90207521940ea54419bbd7244",
        "3ba5a1a24974d54b02bddb577b3c15aa00a8b3b695bb2d34dce9be3457269f2db73c4c55ae529ae975b19b62635493a4",
        "f4d1fed48d63d82c44e386c82ff4575b0ecee43d7414600205cdbaffce1c212aa6b7e6d4d198b91daafc8078fd3ef6c3",
        "128c4e22a78af5a0c8fc3dc81132157fdadf058334883a85147aea4eb02399dcc19f514552898924cd104b35c0b2ac24",
        "563dc71c293ef52654b8acd5b837d08a378dd48d0677b9d100b6e9ee12d12870d6da8b9da0a97c340a61b2af7ac5f5f9",
        "f2a857487afb5c448cbed0cbc329fda3001ecb584112a06804ef06f688f53f6791120dd4e5942b0540f502e46314c0e9",
        "c1fa5a4ed7f5a04c14e863eac659ee2017fce5e26083f19240cb6ab47c222839611d8e9f0b98a2d5267f23fe2ae1f9fc",
        "449e771683431eace8e70e4a188cb61d559b01f00c67a2edf84169deef01e537a7d7d0134c09a13a3b75d9ecaea59c5b",
        "cfae9debe62f1664901ef78e11970f6fd588cf891be076a08eb87185c43d2ece989ab6b4ada409dc0107a6547c47aa28",
        "e6847bc3f90304a84b1b2b60c3c0d34945babbb5df1041a8353792e0e0dc028dca5c91a2f059f334d0607dabfc6e1db2",
        "9fa4ea8396dab80a1c934bc22a4ddb10957b6267eb866d4ccc638de5d72fb57081d69efafa959e010657a148bf93b506",
        "733cea354c2d69cc59c401dad52f0a508e8784a2b11e22d13837d1264dc8fb5899aeaebd92e6704603d673eb1df2dc8f",
        "3545101caf3228ab9cbf70365050444528ef1a967641a82730f7660abfddbd6a02f07f86f7127941c70a663f3b7256e0",
        "6207e7b16406e2eb6498d8991eba959139ed4fb35345b73bdf9beea29417a5a0e4b5a2ceeb159ffd15c82d50bceb76fc",
        "518e11e154b72ac6339742c6c224fa7cb8b070aa9250ed2368a12e72b8f9dd5a70a8ba18b840b8964091132819c0dcd7",
        "533607782e12a0f6f70b14d9d6bac3c1c02514b4aacf604b6fde3b6876ef9b66a35116b24768b6a4b50edf4b551612b3",
        "92f165b927e6a87c5dc239da19eb3daec00ef45340df4e071b48a0c8e0f6dd5e0a386ac5e466a7132c1afd432db152f5",
        "fc6e4d39e9d98f7fc3c35c895f4c206ab784e0d6efe1d06556a6fef9eaefb6a38ebd11b887d347f954086214936a636e",
        "a08dabb686d0ac8136cec2882d64018d6532c6ff33add33ae0fab7f2683ae48ad08f6d9c69e285f2d13128d7c3a4c118",
        "4d10d6148db34145a5e5869765bc5d0c53790983c2098b5d3f20281d05ca7c408da921ba4426683196895803f9fd686d",
        "2a6cc009826818f2f2b21abb639c95cc89b364a93a5d0585e0637f83a747da148c55ce682f5a3433088062cf75dd42d8",
        "41accb2616709bd5f8580f22eae5085b3fdfded11dcd9a3332a25b14e57a1b63cf553d7db1eaef4be55a6d34c66e7a7b",
        "e6a7daaad8ab8afd4d1bbf4c85923bed194466f9b3bc384b2019aab4257722a27c674b92bc8b0b75ca46cf681be631dd",
        "7db9a4380235e2c1de7c25c73a2107b301c60cc32614ca8a1dc1a8543ee6a25988571edf5ab938cd0d0ea9ba98594e2c",
        "f87f95265b2006fda63f2aba003de5760fa5799ef49b092a396fd51da4af2c17131a9127d65147674773bff791b34dc6",
        "aad874cfd30154b350d9ecc39064126b14e5406cf89dec5c914c35aeb96c8737ff35ddc4b1a397c826e7af6b03d0a405",
        "4537c277dda2fff925c3b637ed4d4aea05254933d3485df2dfd71c5bf34ed67e603eac8c679e026debe4272bbc4ee441",
        "304c63ee2e6d8c5164a84e1e3efd00548336e61c67135cad1ee6f7c2ea65c844e85e0973e822525506ff552f2e43d03b",
        "ab27a55ef5a92099f655da8da92ab973e5c1205c07d2ec6b0db3e1c570ebb57c47472c1d4f072220a35d061566f31bde",
        "47b909fe239d3e70ee0bd0eb85e6289c44815b2bf14589fc1c37bfff3dafcb35e557e131de15dcc04e15406cb68798f4",
        "2aef2e21b372d018fb7d17ecdc85660eda2e19d7a2663238116d1ccd8e831efb9f2c11f0d9221f26b931255e8171442c",
        "f52d47eb7ccfff87b8a0180ffd4a3ba3ed569fee4d82b7b02d00222eac9f4d258223d140d598788c9173905f3631742d",
        "cc9148f67024a457cd721abeef438d486a36f6d280424453aabb20935c6e7542fbe280d34551eacb4479e6206cce0507",
        "09c7e52c2848709e9186b8021e88f2260ed614dfbec5824dffe74188c92af31f76dd86a4685ec089a52d104d1c4d2209",
        "25150b21a5de767cb5ddcfc8adc316f739539bb83634800b04ec7e9cd542ded71a6f590cea140c7f227f72383c0a9711",
        "9ba8e179674b71be1322483cc4cc0c4f590fcbcd012a94efd0783953ee38a91cc2b386fd2dda7c6f23e905c96105024a",
        "a2fd33a6e97bfed28fc8af76307bcd308e71e2562290b8d59e7c00e6dce9c986c875acbe449184a382cf5b942c297132",
        "15199eace7d4d14a671091f713d2ee507910ee8db91fe635931bdb83485947d65c06d0e9dbda0e4201a4e7dacfd9fdfb",
        "73d500e86db07d18671881331a36ab46006deb2f73eb34d6d6520906a3098527aa7e8fb2a794c95ee3a6aa3dc8925a3f",
        "60808e31b473f53e5acb3debcb602f8a17be4aa32cdcd71a7e01a8e9d613f16cc42ef1a8cbe2bb9252d5fcffb8c15818",
        "076b4f683f6eaf3dfffe6421f798974ef8acdce3e3b067aab7cca32784803130fefaaebb85b45722c0e8153eb3d00c02",
        "783bfbd781cff0f62909aa16cd8fad67594b526a589190f0d85ce4304ce1cd47d9fd9e8f7307cc77ec3b7325dce19007",
        "e3479e1ff1bb01ca0ceed82647114951d1b878c19747496afadc72745fabbbb40c903ac49f4b36a489ff17d37963d3a6",
        "958c7f3a3f9b80f3d82156d28634ae6932d4a5c0fc51ca96a92fadc8f54e8b2a688c5b54faee4ac43175922f880a0d6b",
        "34073665b89533454a374b24a2c457cb32bdde212b25bbcd1dbd5ad69c150df5ad984df5404bcfcd464e0244c6388b9b",
        "2db87621c961c3fa0327e15debdbb2f08d13f906a2ef54da0c208ed3eaa88f996cbc1803695f378716aa0917579e503c",
        "e071ad1c914fe5899f161933d4716e1c119dcab92119e685c9bcbd9ff4db5659661f1a42d0951ae483ec55fabf75f746",
        "de19d05125d47e974c39b6ad622ee6b9f4a18020e8cf6289f2a34aeaa2dacfdbb45baf6ac748065aa2fe3161b9a51917",
        "0901d9632e6b10855bca9d354165cad870ea0c91dd1e88943b0462375d55692f241cba071252418e8e69c625b7222cf3",
        "5814686ecff0a4d352ecfdd0cc5bc3827f0f366e276e61b31958c2f13ed1331708239e2e627ae709eb20e6fd10adc06e",
        "18deeb6cc0692e228f57f768ea0e391e1fcbec17aa24d978045b7f4c7f0a016a475789ef6eda758a609d836b427f93f4",
        "874fc6d576b4711ac86aeaa80a67e53b9cc7d8e33e88d878ec27a60ab13a1758beba642212d5bfa88e9769cbe7ddd5fd",
        "da4acf0e498a1b44377b96e71ffb23dfa0d4f4374f268ea00d252d20e06d53ee9e77933b1570e26c5dca94754669751f",
        "cde1a1dce59fba7923f8c850466c045e7e9338f698b6f97bcca3e12f6caf9b4c0f1051d583661c88c6020aca8b4ae9a4",
        "64fb79a202d037c291ee450fc08362ff2adc972acec7cccf7ba662e3e3dc1e8c5b21949256cd4dddedcf07c052607e61",
        "f5dc213901c77e323f20c95060b8ad64942e20a3504f99c9fc861cfd44b32d184055198ad8e1df764346b6480ff6b208",
        "67b6a15bfe4dc1c08ebef7f2ca0987c4e388e9fa7dfa5804af6853429cd8c175a9bef4392a7ee5aec1853a735cb95b6c",
        "2cb66e686804fc4be75dbae3dcd543403a7e64870a7e5f44ba761fd6fbd3b9c4fa9ccdf4907572c99b44a931f7d88490",
        "deaeba646cf2540e0c4601557bcbdf33dfe5ddc6c977f81f69772840a7955d6eea28e649f681be94b38f8f7b93c114ed",
        "dbc3bbfb4a59e4c68b0e74dd94424593de9db84992880ad1019473eed468a0550b2fa592d185fb0b652021ba65f5a9ae",
        "7986c8d4fec09ab52d158579b8d7268b3b1e8bf2598e9e623abb61cf8b86e80616916cc5ba915d15428432a36f3015a0",
        "42f674696be31943eda3e466f9982dd71ee8e8191930213a0e3da84b2e50b86b7aab836813dd10a7a2de391fc29f35e3",
        "42328eb6ddf0c3eb72880220d3ae5f7549bad64c6bc95b5c8062480f0900c7cbda0e71ae29c7d3816652361d40300478",
        "e2e797f3d7ebd49b3f4aabeb3ee2a75af4f1ce440dccb6a6be76aed30987af1c00f2dcd6dfdbb09fc3321767d1f7d56a",
        "0af4f1145127d0e523283a896687ae6281ed0b11dd9f8db76d2c9c9f5755519df0e3cafcd2a3168ec2d158a03fe3b31b",
        "421ed8b28695a42863f7f9fd9d226bcd2a269cce0241f7f52aadeaf65d6c78429fab7a522f6733c7ad9b53861da2b289",
        "123c60f50a0090d41b3b6c35b6b9c2090bfb8093da4a4403de604c63896e8082823009894f8445383c278cd7465c24ee",
        "ef65c1475d495b68de302efa5b4382d476fef8cc7bb2bfa6f676a1e13d0f24416fec2143f70f02742ae6ac83daf65969",
        "fd2642e6b1223ca27b5b0c3baa739683e1bc9a4d6531fcf334ec3a7496f45feeee5443ed1b34573bd3ab44840439b049",
        "be0462bfbd66de28d3db681f1d49c57199cce6322fd603720d3b4db259121a68a74fb187119c589c955434356fe0795f",
        "74e57be46309f245096ff133e912a46318cf9fc9cb8bfb328dfb65d2ecc47041766a6186716d61f0cbe41c5834efa2cc",
        "ac0cd4b11b145154810b6fc694b1338eb602bf9c0d86669fa3eeaaabf2ba7ae5fc0e684c7b8c150d064f438e2d34461d",
        "c69add11468c2a0b747dd1a8fbdc298c5bf2c71b3ed7e23c09b3b852ac96b891b7f71bce18b27f46dbb816194c9f6952",
        "b6987c4ebf9492ff306dea820510a9271c4044fcf2391773c132d26a524cdf8c3039f99d6a6d5843b20deb60347f8d5c",
        "6b9ea82b0e12033f0c1338265ab48fc4c8b5933d0290ce1846b45e53fecd20dbbbab386bf896848b2c861d22f73371ce",
        "f0b7219d108f3b20cc63fc34b3e0434768be551f97841d432355a81635be16058631fbcf64923f82a464f94fb2fc96cd",
        "2387e2fc5a94fc079c8905182467de90db2ce4df38f57ef26ae015350e053970005bafe57c795d38474eddee32ed8190",
        "b992990d1b63c8db6bd037831735e0c0d2de8c1377a38ad457786aed892fc56c59adfd8a21dcafe4b0dd004033d0167d",
        "2b970c711f314ba7872df01a7479fb9045cb13ab6874997c7c400cb9254e32554dce3e728c2aa5df874647bf210b151f",
        "61fc7ecb59164b76be1f3da54a4b20b21541ac0a8704052b0c47a7c28b656afde78a0a00f7033533aea4172d23c4595e",
        "74b3f73a6ba1ca8e402aea2837243b4cdbb546765851243cf8a7e99c58db16660953626851d3fab2a0277ee4e33b96a1",
        "3d16340fa6673e23f52d033dcba9fc1597b40217dc043705f1fac150236f4e43859035c094c9f8bc14e2286515a228c9",
        "8773f5be2a9851c54b3ff80748046a4ca615a7f203bbd9b9601a6926d6a92c0ef7339c86129e2f0f6f7c460144b812f3",
        "ff0145db672aca1da189a34bf4178c6df53f8418149b522d8b1dfb3d90e3964e82d9fe35e217d57b6d7ee6a45eea39eb",
        "b759e2321af7f9979c25049c59091d752b9573c14709c4ffea976a887690ca43c43c9023597b02f4f4a3649c9084307c",
        "ed200a4663e2edc3da031c986cd771722199903ebfa08fd8b3555358c7787ff6449d55027d37830cb72da39e8e290f84",
        "c13b89e0caf1bf5b1d7c9aca86418c38e2551367464dad217aef1aff3529a4595fae593668a269bd9592ae2710ab3d77",
        "379d5818304107f68f71319483272f4ccc0c85b006598763d8216c1bd27a3878f794616502908455a7c257b0fbe3e9d8",
        "271e9ceafa0aeaa8d2b5f326b4f4442333e099788b1583eb47e72ff40da744271d7da0f3f9432c2bb64677cfa5f32a0f",
        "efb72ccb5801a2404949c0af98b26fd48b97c987dccb4a4eab7c26d8e18009c415ff83d5c6fcc2da1e8e746c0b33ecb9",
        "e735856e7502c7dcdc758f55ec319a3fe173ada9364bd2a8ff3fa87330b0ab3de49e89134752ad426a26ceae85bc3b84",
        "97fda85376428e5f33777b39fb7098779994081eb46b9bcdd3a3f4eee7f3693863acb735ab64ef2ad019f653536c9803",
        "3ced5964b2bb544f77e6f868441d64e1582563b34d04bd1186525be05196d0958b51d672e2f25c5f883b375feb99c66b",
        "ccf9eb93f430b8bb776801fca2dcef8d2e145f8e6f9dd880f7c986967ff575d4d8a222e57110e067b958602a62e90451",
        "917df67bd7ae898b48dccc0b99ed26d8afa3a0255770acabba0b915b1e932d7e58717f46527b4d4d0a6ce14c9140ee32",
        "26012ae34fcac61c201ecc087e915a493a488260a23f71e565cd5ac84e9a1e12f3b466205b4066db8998ede82fec6aca",
        "c3bc282464b120e3da430162557d76cd3bba89314a9b02b570b0f52bd81348ac1d3f6a6b4affbbce4575a5707ab85759",
        "e808c421d67d770f4dfb864f84ba36c98f4eead373c537f472566e2d3d6fbb9070ef4fb62f92420c180672ba840ccee6",
        "f7334750453fdc6497d700f63903833b098cf1855fcca8f1a743a9fb0076b550425bf46f47088c2bca80926174b3cea5",
        "e0b3b61a747babea213b6d7357dec1d99c6606d98df8dea89e6a1c5b053d15d74542bbfa4bc89b2926a0fd423df5dbcb",
        "f619ed7c8e467566f06f0ee5efe5da428357b5f28c57e195aa14f7600c3027d7837c9b74eefb3c12fcf103d129eb61d4",
        "d385880691793ce1b99c4dfab5914e675200049174ec9daec27e7921b4c7dae4f17c40fbb27276c21457850816a191cb",
        "ef54e6d1cf5ad6043eb20f682df1e28aab50b6745f061b8a16460ab8d928f26b041ded5e0ea673c5b03dbb5548e82c07",
        "e21c06f069c4d0209d277dc4bc2e0e97662337e7d4e2a454ef956d14286b3bca1932391ba97ebf2faa7bdcee5b63537c",
        "91bffe0dcdec21b7b27b2f79853c959dae48c3ff70ae86fd98fa2ad9b26916d302daede8690f66d7cf3fccfbb3b3dd55",
        "ce3e0769769a7e1a9a8e61fcc16ebecf50cab9b837982e687dfcf0a064cdff5e8c71820031193f8703d61cfade360ef3",
        "23f9be05731de284048b0c5448682a4099ba3c7871a9a1d6e0370225d568b57a13478ebbefebf65ee26e72358897843c",
        "1883cc9b291aae6fd3836d869deb3889aa80d8729c2f0692a6235841fa5f48dfed7ec1b5a6c4562ab9ff01bb627b77b2"
    };

    const std::string m_7000 =
        "1c62a04643b3c8749ed03ca29daf304cd70445071d4b8bd960630707405399ea96857902670f99bf2a4dd840c85e33e9";
};

TEST_F(Sha384Tests, Simple) {
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_empty_digest);
}

TEST_F(Sha384Tests, ResetWorks) {
    EXPECT_NO_THROW(m_hfun.update("Hello", 5));
    EXPECT_NO_THROW(m_hfun.reset());
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_empty_digest);
}

TEST_F(Sha384Tests, BasicInput) {
    EXPECT_NO_THROW(m_hfun.update("The quick brown fox jumps over the lazy dog", 43));
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_fox_digest);
}

TEST_F(Sha384Tests, ChoppedInput) {
    EXPECT_NO_THROW(m_hfun.update("The quick brown fox ", 20));
    EXPECT_NO_THROW(m_hfun.update("jumps o", 7));
    EXPECT_NO_THROW(m_hfun.update("ver the la", 10));
    EXPECT_NO_THROW(m_hfun.update("zy dog", 6));
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_fox_digest);
}

TEST_F(Sha384Tests, Extensive) {
    int i, j;
    for (i = 0; i < m_cmp.size(); i++) {
        EXPECT_NO_THROW(m_hfun.reset());
        for (j = 0; j < i; j++)
            EXPECT_NO_THROW(m_hfun.update("A", 1));
        EXPECT_NO_THROW(m_hfun.finalize());
        EXPECT_EQ(m_hfun.hexdigest(), m_cmp.at(i));
    }
}

TEST_F(Sha384Tests, SevenThousandAs) {
    int i;
    for (i = 0; i < 1000; i++)
        EXPECT_NO_THROW(m_hfun.update("AAAAAAA", 7));
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_EQ(m_hfun.hexdigest(), m_7000);
}

TEST_F(Sha384Tests, UpdateAfterFinal) {
    EXPECT_NO_THROW(m_hfun.finalize());
    EXPECT_THROW(m_hfun.update("Hello", 5), std::invalid_argument);
}

TEST_F(Sha384Tests, DigestBeforeFinal) {
    EXPECT_THROW(m_hfun.hexdigest(), std::invalid_argument);
    EXPECT_NO_THROW(m_hfun.reset());

    EXPECT_NO_THROW(m_hfun.update("Hello", 5));
    EXPECT_THROW(m_hfun.hexdigest(), std::invalid_argument);
}
